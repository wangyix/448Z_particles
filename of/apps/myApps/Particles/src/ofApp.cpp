#include "ofApp.h"

#include <assert.h>
#include <algorithm>


static const float wav[WAV_SAMPLES] = { 0.000397, 0.002014, 0.006073, 0.011749, 0.018616, 0.026337, 0.032806, 0.038483, 0.041718, 0.044159, 0.044952, 0.044952, 0.044556, 0.043732, 0.043335, 0.042542, 0.040894, 0.038086, 0.034027, 0.029572, 0.025116, 0.021454, 0.019440, 0.018219, 0.016205, 0.015381, 0.015381, 0.015381, 0.014160, 0.011322, 0.006866, 0.002808, -0.000793, -0.002808, -0.002808, -0.000793, 0.000397, 0.000000, -0.000793, -0.002014, -0.002808, -0.002014, 0.000397, 0.005646, 0.010925, 0.010925, 0.004456, -0.008087, -0.024689, -0.040497, -0.051453, -0.056702, -0.058319, -0.059540, -0.062775, -0.068054, -0.072510, -0.074951, -0.073730, -0.068878, -0.059143, -0.044952, -0.030365, -0.018219, -0.010529, -0.007263, -0.008087, -0.010101, -0.011749, -0.011749, -0.008911, -0.004456, 0.000397, 0.005249, 0.010529, 0.016998, 0.021851, 0.025909, 0.028748, 0.029572, 0.029968, 0.031982, 0.034027, 0.033203, 0.030365, 0.028748, 0.028748, 0.028748, 0.028351, 0.027954, 0.026337, 0.021454, 0.014160, 0.008087, 0.004028, 0.000000, -0.006073, -0.013367, -0.021454, -0.029968, -0.037659, -0.044952, -0.049408, -0.050629, -0.048187, -0.043335, -0.036865, -0.028748, -0.022278, -0.017822, -0.013367, -0.010925, -0.011749, -0.014160, -0.015381, -0.014557, -0.011322, -0.006470, -0.002411, 0.000000, 0.001190, 0.003632, 0.009308, 0.016602, 0.023071, 0.025909, 0.022278, 0.012543, 0.002014, -0.004028, -0.000793, 0.009705, 0.022278, 0.031586, 0.035248, 0.031586, 0.022675, 0.013367, 0.008087, 0.007263, 0.008484, 0.010529, 0.011322, 0.009308, 0.005249, 0.000793, -0.002014, -0.002014, 0.000793, 0.008087, 0.018219, 0.027130, 0.029968, 0.026337, 0.017395, 0.004456, -0.011322, -0.027527, -0.037659, -0.040100, -0.035248, -0.025513, -0.015778, -0.009308, -0.006866, -0.007690, -0.009705, -0.010925, -0.011322, -0.010101, -0.007690, -0.005646, -0.004852, -0.005249, -0.004456, 0.000397, 0.008087, 0.015381, 0.021851, 0.025116, 0.025513, 0.025116, 0.023895, 0.019836, 0.012543, 0.002411, -0.007263, -0.015778, -0.022278, -0.025116, -0.024292, -0.020660, -0.015381, -0.009705, -0.003632, 0.000397, 0.001617, 0.001190, 0.000397, 0.000000, 0.002014, 0.005249, 0.006073, 0.003235, -0.001190, -0.004852, -0.005646, -0.005249, -0.003235, 0.001190, 0.007690, 0.014557, 0.020660, 0.022278, 0.019440, 0.013367, 0.007263, 0.003632, 0.001190, -0.000793, -0.002411, -0.002014, 0.001190, 0.005249, 0.009705, 0.015381, 0.021454, 0.024292, 0.023071, 0.019440, 0.014557, 0.008087, -0.001190, -0.010529, -0.017395, -0.020233, -0.018616, -0.014160, -0.010925, -0.009705, -0.010529, -0.010101, -0.006470, -0.001617, 0.001190, 0.002808, 0.004028, 0.005646, 0.006866, 0.007263, 0.008087, 0.009308, 0.011322, 0.014160, 0.015381, 0.013763, 0.011749, 0.012146, 0.013763, 0.014557, 0.014160, 0.014160, 0.016205, 0.018219, 0.018616, 0.016205, 0.010925, 0.004028, -0.002808, -0.008087, -0.010925, -0.012146, -0.012543, -0.011749, -0.009308, -0.007690, -0.008484, -0.012146, -0.014984, -0.014984, -0.011322, -0.006073, -0.004028, -0.006866, -0.012543, -0.017822, -0.020660, -0.019440, -0.016205, -0.012939, -0.009705, -0.003235, 0.004028, 0.010925, 0.023499, 0.049835, 0.097626, 0.169769, 0.278748, 0.455811, 0.658417, 0.743500, 0.610992, 0.275909, -0.170166, -0.597229, -0.892609, -1.000000, -0.927460, -0.728912, -0.478119, -0.242279, -0.067657, 0.027954, 0.051025, 0.026337, -0.017395, -0.056702, -0.074951, -0.066833, -0.034821, 0.012543, 0.065216, 0.113434, 0.148682, 0.166931, 0.168945, 0.158417, 0.140167, 0.119110, 0.099243, 0.082642, 0.072113, 0.066437, 0.064423, 0.065216, 0.067261, 0.070496, 0.072510, 0.070892, 0.064423, 0.055084, 0.044159, 0.031982, 0.020660, 0.011322, 0.002411, -0.006866, -0.015381, -0.022278, -0.025513, -0.024689, -0.021057, -0.017395, -0.015778, -0.018219, -0.023499, -0.029968, -0.035645, -0.038879, -0.037262, -0.031189, -0.022278, -0.012543, -0.003632, 0.003235, 0.007690, 0.008087, 0.005249, 0.000793, -0.005249, -0.012543, -0.018219, -0.019836, -0.015778, -0.006470, 0.004028, 0.014160, 0.021454, 0.024292, 0.023071, 0.018616, 0.011322, 0.003235, -0.002411, -0.004456, -0.002014, 0.002808, 0.008484, 0.011749, 0.010925, 0.006470, -0.000397, -0.006866, -0.008484, -0.006866, -0.004028, -0.000397, 0.003235, 0.006073, 0.008087, 0.010101, 0.011749, 0.011749, 0.010101, 0.008484, 0.007263, 0.006470, 0.007263, 0.008911, 0.010925, 0.013367, 0.015381, 0.014557, 0.011322, 0.007690, 0.007263, 0.010101, 0.014160, 0.016602, 0.016602, 0.014160, 0.011322, 0.006866, 0.001617, -0.004028, -0.009308, -0.012543, -0.013367, -0.012939, -0.011749, -0.011749, -0.014160, -0.018616, -0.023895, -0.028351, -0.031189, -0.031982, -0.031189, -0.029572, -0.027954, -0.025513, -0.021454, -0.014984, -0.008911, -0.004852, -0.003632, -0.004456, -0.007690, -0.011749, -0.016998, -0.022675, -0.025513, -0.023071, -0.016602, -0.009308, -0.002808, 0.001617, 0.003235, 0.002014, 0.001617, 0.004456, 0.011322, 0.019836, 0.029968, 0.039276, 0.046173, 0.049011, 0.048615, 0.046173, 0.042938, 0.039703, 0.037262, 0.036438, 0.034821, 0.031982, 0.027130, 0.018219, 0.005249, -0.009308, -0.022675, -0.032410, -0.038086, -0.041321, -0.040894, -0.038879, -0.036041, -0.031586, -0.025513, -0.017395, -0.008911, -0.002014, 0.000000, -0.003632, -0.008911, -0.014557, -0.021057, -0.025116, -0.025513, -0.022675, -0.017395, -0.011322, -0.004852, 0.001617, 0.007690, 0.011322, 0.011322, 0.009308, 0.007263, 0.004852, 0.004456, 0.004852, 0.004028, 0.001617, -0.002014, -0.006866, -0.014160, -0.021057, -0.023071, -0.019440, -0.012146, -0.004456, 0.001617, 0.002808, -0.001617, -0.010925, -0.023071, -0.032806, -0.038086, -0.036438, -0.026733, -0.009308, 0.009705, 0.022278, 0.025513, 0.020660, 0.010529, -0.001190, -0.011322, -0.015778, -0.015778, -0.010925, -0.002411, 0.006073, 0.010101, 0.010101, 0.006866, 0.002808, 0.000000, -0.000397, 0.002411, 0.007263, 0.012939, 0.018219, 0.021057, 0.021057, 0.016998, 0.009308, 0.001617, -0.002808, -0.002808, 0.003235, 0.012543, 0.021057, 0.026337, 0.027527, 0.023895, 0.019043, 0.015381, 0.015778, 0.019043, 0.021851, 0.023499, 0.023499, 0.021454, 0.016602, 0.011749, 0.006073, 0.000397, -0.005646, -0.012543, -0.019836, -0.026733, -0.031189, -0.033203, -0.033630, -0.031982, -0.027954, -0.024689, -0.022278, -0.020233, -0.018616, -0.016998, -0.016205, -0.018219, -0.021454, -0.025513, -0.029968, -0.033203, -0.034027, -0.032806, -0.028748, -0.022278, -0.014557, -0.004852, 0.004852, 0.014160, 0.021454, 0.026337, 0.030365, 0.031982, 0.030792, 0.028748, 0.024689, 0.020233, 0.018616, 0.019440, 0.021057, 0.021057, 0.018616, 0.014160, 0.009308, 0.004456, 0.002411, 0.003632, 0.008087, 0.013367, 0.015381, 0.013763, 0.010529, 0.004028, -0.003632, -0.011322, -0.016205, -0.017395, -0.015381, -0.012146, -0.008911, -0.004852, -0.000793, 0.002808, 0.005249, 0.004456, 0.001190, -0.001190, -0.002808, -0.003632, -0.004456, -0.003235, 0.002014, 0.009308, 0.015381, 0.018219, 0.019043, 0.019043, 0.018616, 0.016602, 0.012543, 0.009308, 0.006866, 0.006470, 0.009308, 0.015381, 0.023499, 0.030365, 0.034821, 0.036438, 0.034027, 0.025116, 0.011322, -0.004028, -0.016602, -0.024689, -0.027527, -0.027527, -0.025513, -0.021454, -0.016602, -0.013763, -0.013367, -0.014984, -0.015778, -0.014160, -0.009308, -0.003632, -0.000397, 0.000793, 0.000793, -0.000397, -0.001190, 0.000000, 0.005249, 0.012543, 0.018219, 0.021057, 0.023499, 0.027130, 0.032806, 0.036438, 0.034821, 0.027527, 0.017395, 0.007690, 0.002808, 0.004852, 0.011749, 0.019043, 0.023895, 0.024689, 0.018219, 0.007690, -0.003632, -0.013763, -0.022675, -0.028351, -0.029968, -0.028748, -0.025116, -0.019836, -0.015381, -0.013367, -0.013763, -0.016602, -0.020660, -0.023895, -0.023499, -0.021057, -0.016998, -0.014557, -0.014557, -0.017395, -0.021057, -0.022675, -0.022278, -0.019836, -0.015381, -0.009308, -0.004028, 0.001190, 0.005646, 0.008087, 0.008911, 0.010101, 0.013367, 0.019836, 0.027954, 0.034424, 0.036041, 0.032806, 0.025909, 0.017822, 0.009308, 0.001190, -0.005646, -0.011322, -0.015778, -0.019043, -0.020233, -0.017822, -0.012543, -0.006866, -0.003235, -0.002411, -0.006470, -0.014160, -0.023499, -0.029144, -0.029968, -0.025909, -0.018616, -0.009308, 0.001617, 0.013367, 0.024689, 0.034424, 0.042114, 0.048187, 0.052246, 0.054688, 0.056702, 0.058319, 0.056702, 0.050232, 0.039276, 0.026733, 0.014984, 0.006073, 0.000000, -0.003632, -0.006073, -0.007263, -0.008087, -0.008911, -0.010529, -0.012543, -0.014160, -0.014557, -0.012939, -0.011322, -0.011322, -0.012939, -0.016998, -0.021454, -0.024689, -0.025909, -0.025513, -0.023895, -0.022675, -0.022278, -0.021454, -0.020660, -0.018219, -0.012939, -0.006470, 0.000397, 0.005249, 0.006866, 0.007263, 0.006470, 0.004028, 0.000793, -0.001617, -0.002808, -0.002411, -0.001617, 0.001190, 0.005646, 0.010101, 0.014160, 0.016602, 0.014984, 0.008911, -0.002014, -0.015778, -0.027954, -0.034821, -0.034424, -0.028351, -0.016998, -0.002014, 0.011749, 0.019043, 0.019043, 0.013763, 0.006470, -0.001617, -0.008911, -0.014557, -0.016998, -0.016205, -0.013763, -0.011749, -0.011322, -0.013763, -0.016998, -0.019836, -0.019440, -0.016602, -0.012146, -0.006866, -0.001617, 0.001617, 0.000793, -0.002411, -0.004456, -0.003632, -0.000397, 0.003632, 0.008087, 0.011322, 0.012543, 0.012939, 0.012543, 0.012146, 0.013367, 0.016998, 0.020660, 0.023499, 0.024292, 0.024292, 0.023071, 0.022278, 0.021851, 0.021851, 0.021454, 0.019043, 0.014557, 0.010925, 0.009705, 0.010925, 0.011322, 0.008484, 0.002411, -0.005249, -0.014160, -0.021454, -0.025909, -0.027527, -0.026337, -0.023499, -0.019836, -0.014984, -0.010101, -0.005249, -0.002808, -0.004456, -0.007263, -0.008911, -0.008484, -0.007263, -0.006866, -0.007263, -0.007690, -0.009705, -0.011749, -0.010925, -0.008087, -0.003632, 0.002411, 0.006866, 0.006866, 0.003632, 0.000000, -0.002411, -0.003235, -0.003632, -0.002411, -0.000397, 0.004456, 0.010925, 0.017822, 0.023071, 0.025513, 0.023895, 0.019440, 0.012939, 0.006073, 0.001617, 0.000397, 0.003632, 0.010101, 0.014557, 0.014557, 0.010529, 0.005249, 0.001190, -0.000397, 0.000397, 0.002411, 0.005249, 0.007263, 0.008911, 0.008911, 0.006866, 0.003235, -0.003235, -0.012146, -0.021057, -0.027527, -0.029144, -0.025909, -0.019440, -0.010925, -0.003235, 0.000793, 0.003235, 0.003235, 0.001190, 0.000397, 0.000397, -0.000397, -0.002014, -0.003632, -0.004028, -0.003235, -0.002014, -0.002411, -0.003632, -0.005646, -0.007263, -0.009705, -0.011322, -0.010529, -0.008911, -0.006470, -0.002808, -0.000397, 0.000397, 0.001617, 0.003235, 0.004456, 0.004456, 0.004852, 0.007263, 0.010529, 0.012146, 0.011749, 0.010925, 0.009705, 0.007263, 0.004852, 0.002411, 0.000000, -0.002014, -0.004028, -0.007263, -0.010925, -0.012543, -0.011322, -0.006470, 0.001190, 0.007263, 0.006470, -0.000397, -0.009308, -0.017395, -0.023071, -0.023895, -0.020660, -0.014160, -0.006866, -0.000793, 0.002808, 0.003632, 0.003235, 0.004028, 0.004456, 0.004456, 0.004456, 0.004028, 0.002411, -0.000397, -0.005646, -0.011749, -0.016205, -0.018219, -0.016205, -0.010925, -0.003235, 0.005249, 0.011322, 0.011749, 0.004852, -0.006470, -0.018219, -0.027130, -0.029572, -0.026733, -0.020660, -0.012543, -0.003235, 0.004852, 0.009705, 0.010529, 0.006073, -0.001190, -0.009308, -0.015778, -0.019440, -0.019043, -0.015778, -0.008911, 0.000793, 0.012146, 0.021057, 0.025909, 0.025513, 0.022278, 0.018219, 0.015778, 0.012939, 0.008911, 0.004852, 0.000793, -0.003632, -0.008087, -0.010529, -0.010101, -0.006073, 0.001190, 0.010101, 0.016998, 0.020233, 0.019836, 0.017395, 0.013367, 0.009705, 0.006470, 0.002808, -0.002411, -0.009308, -0.014984, -0.019440, -0.023071, -0.024292, -0.023499, -0.021454, -0.020233, -0.019440, -0.019440, -0.021454, -0.025909, -0.032806, -0.040894, -0.048187, -0.053467, -0.056305, -0.055908, -0.051849, -0.044556, -0.036865, -0.028748, -0.020660, -0.012146, -0.002411, 0.007263, 0.013763, 0.016602, 0.018219, 0.020233, 0.023071, 0.023895, 0.024292, 0.023895, 0.023499, 0.024689, 0.028748, 0.034027, 0.040100, 0.045776, 0.050629, 0.054291, 0.056305, 0.056305, 0.053864, 0.049011, 0.040894, 0.031586, 0.023895, 0.019440, 0.016602, 0.013763, 0.010925, 0.010529, 0.012146, 0.013367, 0.011749, 0.009705, 0.007690, 0.004028, -0.001617, -0.007263, -0.012146, -0.014984, -0.016602, -0.018219, -0.021454, -0.025909, -0.030365, -0.033630, -0.035645, -0.036438, -0.034821, -0.029968, -0.022675, -0.015778, -0.007690, 0.001190, 0.006470, 0.007263, 0.006470, 0.006073, 0.006470, 0.006073, 0.005646, 0.006470, 0.008911, 0.012146, 0.016205, 0.020660, 0.023499, 0.023895, 0.021454, 0.018219, 0.015778, 0.014160, 0.012146, 0.009705, 0.006073, 0.002808, 0.002014, 0.004028, 0.008911, 0.014160, 0.018219, 0.020233, 0.020660, 0.020233, 0.021454, 0.024689, 0.028748, 0.032410, 0.031586, 0.023499, 0.010101, -0.004028, -0.015381, -0.021057, -0.020233, -0.016205, -0.013763, -0.015381, -0.018616, -0.022278, -0.025909, -0.029144, -0.032806, -0.036041, -0.039703, -0.044159, -0.047791, -0.048187, -0.044952, -0.038483, -0.031189, -0.025513, -0.023071, -0.021851, -0.017822, -0.010925, -0.003632, 0.003235, 0.008911, 0.011749, 0.012146, 0.012543, 0.013763, 0.017395, 0.022675, 0.027527, 0.033203, 0.040100, 0.046173, 0.048615, 0.047791, 0.044159, 0.037659, 0.028748, 0.020233, 0.012939, 0.007263, 0.004028, 0.002808, 0.002014, 0.000397, -0.003632, -0.007690, -0.009308, -0.009308, -0.008087, -0.004852, 0.000000, 0.003632, 0.004456, 0.002411, -0.002014, -0.008484, -0.015381, -0.018219, -0.016602, -0.011749, -0.005249, 0.000793, 0.004852, 0.007690, 0.010101, 0.014984, 0.019836, 0.020660, 0.017822, 0.012939, 0.007690, 0.004028, 0.002411, 0.003235, 0.005249, 0.006470, 0.007690, 0.009308, 0.010925, 0.012543, 0.013763, 0.014160, 0.012146, 0.007690, 0.001190, -0.004456, -0.008087, -0.006470, 0.000397, 0.009308, 0.016602, 0.020660, 0.019836, 0.015381, 0.008484, -0.000397, -0.010925, -0.020660, -0.026733, -0.027954, -0.027130, -0.025116, -0.022278, -0.019440, -0.016602, -0.014160, -0.013367, -0.013367, -0.014160, -0.015381, -0.014557, -0.010529, -0.004028, 0.002411, 0.006866, 0.010925, 0.015778, 0.019043, 0.019836, 0.017822, 0.012543, 0.006470, 0.000793, -0.004456, -0.007690, -0.007690, -0.005249, -0.003235, -0.002808, -0.003632, -0.004852, -0.008087, -0.012146, -0.015381, -0.016998, -0.015778, -0.012939, -0.008087, -0.001617, 0.007263, 0.016205, 0.022675, 0.024689, 0.022675, 0.018616, 0.012543, 0.007263, 0.005249, 0.007263, 0.009308, 0.008484, 0.003632, -0.002014, -0.006866, -0.010925, -0.012939, -0.015381, -0.019440, -0.025116, -0.029968, -0.031586, -0.027954, -0.021057, -0.011322, -0.002411, 0.002411, 0.001617, -0.002014, -0.007263, -0.013367, -0.017822, -0.019440, -0.018219, -0.016602, -0.016602, -0.017822, -0.019440, -0.021057, -0.020233, -0.016602, -0.010925, -0.004028, 0.002411, 0.006866, 0.009308, 0.008484, 0.002808, -0.004028, -0.008484, -0.009308, -0.006073, 0.002014, 0.014557, 0.026733, 0.033630, 0.032806, 0.023499, 0.009705, -0.002411, -0.011322, -0.014557, -0.011749, -0.004456, 0.005646, 0.015381, 0.021057, 0.019836, 0.012146, -0.000793, -0.013367, -0.022675, -0.026733, -0.025909, -0.020660, -0.011749, -0.001190, 0.008484, 0.014557, 0.016998, 0.016602, 0.014160, 0.010529, 0.007263, 0.005249, 0.004028, 0.004028, 0.006073, 0.009308, 0.011322, 0.010529, 0.007690, 0.002808, -0.002014, -0.004456, -0.002808, 0.000397, 0.003235, 0.006073, 0.008911, 0.011322, 0.013763, 0.016205, 0.018616, 0.019836, 0.020233, 0.022278, 0.025116, 0.025513, 0.021454, 0.014557, 0.005646, -0.002808, -0.011322, -0.019836, -0.027954, -0.034027, -0.036041, -0.036041, -0.036041, -0.038483, -0.043732, -0.049835, -0.052673, -0.051849, -0.046570, -0.036865, -0.023071, -0.008484, 0.006073, 0.018219, 0.025116, 0.023895, 0.016602, 0.006866, -0.002411, -0.008087, -0.008911, -0.005249, 0.000793, 0.006470, 0.009705, 0.011322, 0.012939, 0.013763, 0.014160, 0.015381, 0.017822, 0.021454, 0.026337, 0.029572, 0.029968, 0.027130, 0.023499, 0.020660, 0.017822, 0.014160, 0.010101, 0.006866, 0.002808, -0.003235, -0.010529, -0.015778, -0.019043, -0.019440, -0.015381, -0.008484, -0.000397, 0.005249, 0.006866, 0.004028, -0.000793, -0.006073, -0.012146, -0.016998, -0.018616, -0.016205, -0.010925, -0.006866, -0.006073, -0.007263, -0.008087, -0.007263, -0.006073, -0.003235, 0.001617, 0.006866, 0.010529, 0.011749, 0.008911, 0.004456, -0.000397, -0.004456, -0.007263, -0.008484, -0.009308, -0.008484, -0.006866, -0.005646, -0.006073, -0.006073, -0.005646, -0.004028, -0.001190, 0.002014, 0.005249, 0.006866, 0.007263, 0.008087, 0.009705, 0.012146, 0.012939, 0.012543, 0.011322, 0.009705, 0.007690, 0.006073, 0.005249, 0.006073, 0.008087, 0.010529, 0.010529, 0.006866, 0.000397, -0.006470, -0.011322, -0.012939, -0.010925, -0.006470, -0.000397, 0.006073, 0.012146, 0.016205, 0.016602, 0.013367, 0.008087, 0.002411, -0.002411, -0.003235, 0.000793, 0.009705, 0.019836, 0.025513, 0.025116, 0.018219, 0.007263, -0.004028, -0.012543, -0.015778, -0.014160, -0.011749, -0.009308, -0.008484, -0.010529, -0.012939, -0.012543, -0.010925, -0.008484, -0.006470, -0.005646, -0.006470, -0.009308, -0.012146, -0.011322, -0.006470, 0.001617, 0.009705, 0.016602, 0.021454, 0.022675, 0.020233, 0.016205, 0.011749, 0.008484, 0.006470, 0.004028, 0.001617, -0.000397, -0.002014, -0.002014, -0.000793, 0.000793, 0.003632, 0.007690, 0.012543, 0.017822, 0.021057, 0.022278, 0.021057, 0.017395, 0.013367, 0.008911, 0.001617, -0.007690, -0.016998, -0.023895, -0.024292, -0.020233, -0.014160, -0.007263, -0.001190, 0.003632, 0.006866, 0.007263, 0.005646, 0.004028, 0.002411, 0.003235, 0.006073, 0.009308, 0.011322, 0.013367, 0.014984, 0.016998, 0.018219, 0.019836, 0.019440, 0.016205, 0.010529, 0.004028, -0.002014, -0.005646, -0.006073, -0.005249, -0.004852, -0.005249, -0.005646, -0.002808, 0.001617, 0.005646, 0.007690, 0.006073, 0.000000, -0.008484, -0.015778, -0.016998, -0.012543, -0.005646, 0.001190, 0.005249, 0.004456, 0.000397, -0.006470, -0.014984, -0.023895, -0.029968, -0.030792, -0.024292, -0.013367, -0.002411, 0.004028, 0.005249, 0.002808, -0.002411, -0.010101, -0.017395, -0.022278, -0.025909, -0.027130, -0.025909, -0.022675, -0.018616, -0.014160, -0.008484, -0.002808, 0.001190, 0.004028, 0.006470, 0.008484, 0.009308, 0.008911, 0.009308, 0.011749, 0.014557, 0.017822, 0.020233, 0.019043, 0.015381, 0.012146, 0.010925, 0.010101, 0.008911, 0.006073, 0.002014, -0.002014, -0.005249, -0.009705, -0.014984, -0.018219, -0.018219, -0.016602, -0.012543, -0.008087, -0.004852, -0.004028, -0.007263, -0.011749, -0.013367, -0.012543, -0.009705, -0.004456, 0.001617, 0.006470, 0.011322, 0.015778, 0.018616, 0.020660, 0.019836, 0.018219, 0.015381, 0.010925, 0.006470, 0.004028, 0.007263, 0.015778, 0.026733, 0.035645, 0.039703, 0.038483, 0.032410, 0.022675, 0.012543, 0.004028, -0.002014, -0.005249, -0.005646, -0.005249, -0.004456, -0.004456, -0.005646, -0.008087, -0.010925, -0.012146, -0.011749, -0.009308, -0.006470, -0.005249, -0.007263, -0.012146, -0.018219, -0.021454, -0.022278, -0.020233, -0.016602, -0.010925, -0.004028, 0.002014, 0.004456, 0.006470, 0.010101, 0.014557, 0.018616, 0.022278, 0.024292, 0.024292, 0.023071, 0.023499, 0.025909, 0.029144, 0.031982, 0.032806, 0.031189, 0.027527, 0.023071, 0.016205, 0.007263, -0.002014, -0.008484, -0.012146, -0.013763, -0.015778, -0.017822, -0.019836, -0.021057, -0.021057, -0.019440, -0.015381, -0.010925, -0.007263, -0.006073, -0.006866, -0.007690, -0.008484, -0.008911, -0.007690, -0.005646, -0.004028, -0.003235, -0.004028, -0.004852, -0.003632, -0.001190, 0.002808, 0.005646, 0.005249, 0.002411, 0.000397, 0.001190, 0.003632, 0.005646, 0.006073, 0.006073, 0.004852, 0.000793, -0.005249, -0.010925, -0.013367, -0.012543, -0.008911, -0.005646, -0.004852, -0.007263, -0.012543, -0.018616, -0.023895, -0.026733, -0.026733, -0.023071, -0.016205, -0.009705, -0.005646, -0.002411, 0.001190, 0.003632, 0.004456, 0.005249, 0.008484, 0.012146, 0.014984, 0.016205, 0.014557, 0.010925, 0.006866, 0.003235, -0.001190, -0.004456, -0.004028, -0.000793, 0.002014, 0.002808, -0.000397, -0.007263, -0.016205, -0.024292, -0.029572, -0.031189, -0.029572, -0.025909, -0.019836, -0.014160, -0.011322, -0.011749, -0.014160, -0.016998, -0.016998, -0.015778, -0.014984, -0.014984, -0.014984, -0.015381, -0.014160, -0.009308, -0.000397, 0.010529, 0.020233, 0.027130, 0.030365, 0.031189, 0.031189, 0.031586, 0.031586, 0.031189, 0.029144, 0.025116, 0.020233, 0.015381, 0.012146, 0.012543, 0.016998, 0.022278, 0.025116, 0.024292, 0.019836, 0.011322, 0.000793, -0.007263, -0.012146, -0.014984, -0.016205, -0.015778, -0.013367, -0.009705, -0.007263, -0.008087, -0.012543, -0.018616, -0.024689, -0.029572, -0.031189, -0.029144, -0.023895, -0.014984, -0.004456, 0.004456, 0.010529, 0.014557, 0.016205, 0.014557, 0.011322, 0.007690, 0.003632, -0.002014, -0.009705, -0.017395, -0.023071, -0.025513, -0.025116, -0.021851, -0.016998, -0.011749, -0.008087, -0.006866, -0.005249, -0.002411, 0.001617, 0.005646, 0.009308, 0.012146, 0.013763, 0.013367, 0.012146, 0.012146, 0.012543, 0.011322, 0.007263, 0.000793, -0.006470, -0.010529, -0.010101, -0.004852, 0.000793, 0.004028, 0.004852, 0.004028, 0.000793, -0.005249, -0.012543, -0.019440, -0.023499, -0.024689, -0.023895, -0.022675, -0.021454, -0.021057, -0.021057, -0.020233, -0.019043, -0.015778, -0.009308, -0.001617, 0.005249, 0.010925, 0.013367, 0.013367, 0.011322, 0.009308, 0.008484, 0.007263, 0.005249, 0.002014, -0.000793, -0.002014, -0.001190, 0.000000, 0.003235, 0.008911, 0.014160, 0.016602, 0.016205, 0.014160, 0.012939, 0.011322, 0.008911, 0.006073, 0.003235, 0.000793, 0.000793, 0.000793, 0.001617, 0.002411, 0.004028, 0.006073, 0.007690, 0.007690, 0.007263, 0.006073, 0.003632, 0.000000, -0.004028, -0.005249, -0.003235, -0.000397, 0.001190, 0.001617, 0.000397, -0.000793, -0.002411, -0.003632, -0.004456, -0.005646, -0.007690, -0.008484, -0.008087, -0.008484, -0.008911, -0.009705, -0.008484, -0.005249, -0.000793, 0.003632, 0.007690, 0.009308, 0.010101, 0.010101, 0.010101, 0.009308, 0.008087, 0.006470, 0.006470, 0.007263, 0.008087, 0.008484, 0.007263, 0.006470, 0.007690, 0.011749, 0.017822, 0.025513, 0.032410, 0.037659, 0.039703, 0.037659, 0.031982, 0.024292, 0.016602, 0.011322, 0.006866, 0.002808, -0.000397, -0.002411, -0.004456, -0.006866, -0.009705, -0.012543, -0.016205, -0.019440, -0.021057, -0.020233, -0.019043, -0.018219, -0.018616, -0.019836, -0.021057, -0.021454, -0.020233, -0.016998, -0.012543, -0.008911, -0.008911, -0.013367, -0.019043, -0.024689, -0.027130, -0.025513, -0.021851, -0.017395, -0.012543, -0.007690, -0.002411, 0.002808, 0.007690, 0.012543, 0.017822, 0.022675, 0.028748, 0.034424, 0.037659, 0.038483, 0.036865, 0.033630, 0.029572, 0.025513, 0.022278, 0.020233, 0.020660, 0.023499, 0.027130, 0.031189, 0.034027, 0.032410, 0.027527, 0.021454, 0.014557, 0.008911, 0.006470, 0.008087, 0.011749, 0.013763, 0.012146, 0.006073, -0.001617, -0.008484, -0.012146, -0.013763, -0.014557, -0.014984, -0.013367, -0.010925, -0.008087, -0.005249, -0.003632, -0.001190, 0.001617, 0.002014, 0.000000, -0.003632, -0.008911, -0.014557, -0.018219, -0.016998, -0.012939, -0.008484, -0.004852, -0.004456, -0.007263, -0.012146, -0.017395, -0.022278, -0.025116, -0.025116, -0.021851, -0.016602, -0.010925, -0.006470, -0.004456, -0.004028, -0.003235, -0.002411, -0.002014, -0.001617, -0.001190, -0.000793, 0.001617, 0.005249, 0.010925, 0.016602, 0.021454, 0.024689, 0.025116, 0.023071, 0.018219, 0.012146, 0.006470, 0.002411, 0.000397, 0.000000, 0.001617, 0.004456, 0.007263, 0.006866, 0.002808, -0.002808, -0.008484, -0.013763, -0.017822, -0.019836, -0.019836, -0.019440, -0.017822, -0.014557, -0.011322, -0.009705, -0.009308, -0.008911, -0.007690, -0.005249, -0.004456, -0.004852, -0.006470, -0.008484, -0.010101, -0.010925, -0.011749, -0.011322, -0.010529, -0.008087, -0.004852, -0.000793, 0.001190, 0.000000, -0.004852, -0.010101, -0.012543, -0.011749, -0.011322, -0.010925, -0.008484, -0.004028, 0.000397, 0.003632, 0.004852, 0.004456, 0.002808, 0.001190, 0.001190, 0.002411, 0.004852, 0.006866, 0.007690, 0.008087, 0.007690, 0.006470, 0.005249, 0.004028, 0.002808, 0.001617, 0.000793, -0.000397, -0.000397, 0.000793, 0.002014, 0.002014, 0.000793, -0.001617, -0.004852, -0.008087, -0.010925, -0.013367, -0.013763, -0.011749, -0.008087, -0.003235, 0.001190, 0.003632, 0.002411, -0.002411, -0.009705, -0.016602, -0.020660, -0.019440, -0.014160, -0.006470, 0.000793, 0.005646, 0.007690, 0.009705, 0.011749, 0.012146, 0.012146, 0.012543, 0.013367, 0.015778, 0.019440, 0.023071, 0.025909, 0.027527, 0.027527, 0.025116, 0.020233, 0.012146, 0.002808, -0.006470, -0.013763, -0.017822, -0.018616, -0.015778, -0.011322, -0.008484, -0.007690, -0.009308, -0.012543, -0.015381, -0.015778, -0.013367, -0.007263, 0.000397, 0.006866, 0.010101, 0.010529, 0.009705, 0.009308, 0.010101, 0.011749, 0.012543, 0.012939, 0.012543, 0.010529, 0.007263, 0.004028, 0.003235, 0.005249, 0.008911, 0.011322, 0.011322, 0.008087, 0.002808, -0.003235, -0.008484, -0.011749, -0.012146, -0.012543, -0.014557, -0.019043, -0.023499, -0.024292, -0.020660, -0.012939, -0.003632, 0.003632, 0.007263, 0.007263, 0.003632, -0.002014, -0.008087, -0.013367, -0.016998, -0.019440, -0.019440, -0.015381, -0.009705, -0.003632, 0.002411, 0.007263, 0.013367, 0.019043, 0.023895, 0.026733, 0.027527, 0.025513, 0.023071, 0.019043, 0.014557, 0.010529, 0.007263, 0.005249, 0.005249, 0.007263, 0.010529, 0.013367, 0.014984, 0.015778, 0.015381, 0.013367, 0.010529, 0.006866, 0.002411, -0.002014, -0.005646, -0.006866, -0.004852, -0.000793, 0.003632, 0.008484, 0.010925, 0.010529, 0.006866, 0.002014, -0.002014, -0.004456, -0.005249, -0.004852, -0.005646, -0.007263, -0.009308, -0.010925, -0.011322, -0.009705, -0.007690, -0.005646, -0.004852, -0.004852, -0.004456, -0.003632, -0.002014, 0.000000, 0.001190, 0.002411, 0.002014, 0.000793, -0.001190, -0.003632, -0.005646, -0.005646, -0.003632, 0.001190, 0.008087, 0.014984, 0.019440, 0.021454, 0.021057, 0.018219, 0.012543, 0.004852, -0.003235, -0.009308, -0.011322, -0.009705, -0.004456, 0.002808, 0.010529, 0.016998, 0.020660, 0.021057, 0.016998, 0.010529, 0.003235, -0.003632, -0.008911, -0.011749, -0.011749, -0.009308, -0.006470, -0.004852, -0.005249, -0.008087, -0.011749, -0.014984, -0.016998, -0.017822, -0.017822, -0.016602, -0.014557, -0.012146, -0.010529, -0.009308, -0.008911, -0.009308, -0.010925, -0.012146, -0.012939, -0.013367, -0.012543, -0.011749, -0.010529, -0.008911, -0.006470, -0.003632, -0.000793, 0.002411, 0.005249, 0.006470, 0.006073, 0.004456, 0.001190, -0.002808, -0.007263, -0.010101, -0.009705, -0.006470, 0.000397, 0.009308, 0.015778, 0.018219, 0.017395, 0.014160, 0.010529, 0.007690, 0.006073, 0.004456, 0.002014, -0.001190, -0.005249, -0.010101, -0.015381, -0.019440, -0.021454, -0.022278, -0.021851, -0.021057, -0.019440, -0.016998, -0.014557, -0.011322, -0.008911, -0.007263, -0.006073, -0.005646, -0.004852, -0.002411, 0.001617, 0.006470, 0.010101, 0.012543, 0.013763, 0.012146, 0.009308, 0.005646, 0.002411, 0.001190, 0.003235, 0.008087, 0.013763, 0.018616, 0.021057, 0.019440, 0.014557, 0.008911, 0.004852, 0.003235, 0.003632, 0.004852, 0.005646, 0.004852, 0.004456, 0.005249, 0.006470, 0.007263, 0.006470, 0.004028, 0.001190, -0.002014, -0.004852, -0.006470, -0.007690, -0.008484, -0.007263, -0.004456, -0.002411, -0.001617, -0.002014, -0.002411, -0.003235, -0.005249, -0.007690, -0.010101, -0.012543, -0.013763, -0.013367, -0.012146, -0.010529, -0.009308, -0.007263, -0.004456, -0.000793, 0.002014, 0.002014, 0.000793, 0.000397, 0.001617, 0.003235, 0.004028, 0.003632, 0.002808, 0.002808, 0.002411, 0.002014, 0.002411, 0.003632, 0.006073, 0.009308, 0.012543, 0.015778, 0.017822, 0.019043, 0.018219, 0.015381, 0.012146, 0.010101, 0.010101, 0.012146, 0.014160, 0.015778, 0.016602, 0.015381, 0.012543, 0.008484, 0.004852, 0.002411, 0.001190, 0.000000, -0.000793, -0.002411, -0.004852, -0.006866, -0.008484, -0.010529, -0.013367, -0.016205, -0.017395, -0.016998, -0.014557, -0.011322, -0.007263, -0.004852, -0.004456, -0.006073, -0.008484, -0.010101, -0.009705, -0.008484, -0.006470, -0.004028, -0.002808, -0.004028, -0.006073, -0.007690, -0.006073, -0.002808, 0.000397, 0.002808, 0.003235, 0.002411, 0.000793, -0.000397, -0.000793, 0.000000, 0.001617, 0.003235, 0.003632, 0.003235, 0.003632, 0.006073, 0.009308, 0.012146, 0.013367, 0.012543, 0.008911, 0.004028, -0.001617, -0.006470, -0.008484, -0.008484, -0.007263, -0.005249, -0.003632, -0.004028, -0.005646, -0.006866, -0.006470, -0.003235, 0.001617, 0.006866, 0.010925, 0.012939, 0.013367, 0.011322, 0.007263, 0.001617, -0.003632, -0.008484, -0.011749, -0.012939, -0.013367, -0.012939, -0.012146, -0.011322, -0.010925, -0.009705, -0.007690, -0.005249, -0.002411, -0.000397, 0.000397, -0.000793, -0.001617, -0.002014, -0.000793, 0.002411, 0.006866, 0.012146, 0.017395, 0.021057, 0.023071, 0.023895, 0.023499, 0.020660, 0.016602, 0.012543, 0.008911, 0.006073, 0.003632, 0.002014, 0.002014, 0.002808, 0.003235, 0.003235, 0.003235, 0.002411, 0.000397, -0.000793, -0.002014, -0.002808, -0.002808, -0.002014, -0.000397, 0.001617, 0.004028, 0.005646, 0.006073, 0.004456, 0.001190, -0.002808, -0.006470, -0.008484, -0.007690, -0.005646, -0.003235, -0.001617, -0.000793, -0.000793, -0.001617, -0.003235, -0.004852, -0.006470, -0.006866, -0.007263, -0.007263, -0.006866, -0.006470, -0.006073, -0.006073, -0.004028, -0.000793, 0.001190, 0.001617, 0.000793, -0.000793, -0.002411, -0.003235, -0.003632, -0.003235, -0.000793, 0.001617, 0.003235, 0.004456, 0.004456, 0.004028, 0.003632, 0.001617, -0.001617, -0.004456, -0.006073, -0.006073, -0.004852, -0.003632, -0.002411, -0.002014, -0.002411, -0.003632, -0.005646, -0.007263, -0.006866, -0.003632, 0.001617, 0.007690, 0.011749, 0.014160, 0.015381, 0.016602, 0.018616, 0.021057, 0.022278, 0.021851, 0.019043, 0.013763, 0.008087, 0.004028, 0.001190, -0.001617, -0.004852, -0.008087, -0.010101, -0.011322, -0.011322, -0.010101, -0.008911, -0.007690, -0.006866, -0.007263, -0.008911, -0.010529, -0.012146, -0.014160, -0.018219, -0.023499, -0.028748, -0.032410, -0.033630, -0.031189, -0.026733, -0.020660, -0.014160, -0.008087, -0.003235, -0.000793, -0.000793, -0.002014, -0.003632, -0.004028, -0.001190, 0.004456, 0.011322, 0.017395, 0.021057, 0.022675, 0.023499, 0.024292, 0.024689, 0.024689, 0.024292, 0.022675, 0.019440, 0.015778, 0.011322, 0.006470, 0.002411, 0.000000, -0.002014, -0.004456, -0.007690, -0.012146, -0.017822, -0.024689, -0.030792, -0.034821, -0.035645, -0.032806, -0.027130, -0.019440, -0.012939, -0.006866, -0.001617, 0.002411, 0.004852, 0.005646, 0.004852, 0.003235, 0.001190, 0.000397, 0.000397, 0.001190, 0.002808, 0.004028, 0.004456, 0.003235, 0.002411, 0.002411, 0.004028, 0.007263, 0.009308, 0.009705, 0.008087, 0.007690, 0.009705, 0.012543, 0.015778, 0.017822, 0.018219, 0.017395, 0.016205, 0.014557, 0.013367, 0.012543, 0.012939, 0.014160, 0.015778, 0.016205, 0.015381, 0.012939, 0.009705, 0.006470, 0.003632, 0.002014, 0.000397, -0.000793, -0.001617, -0.002808, -0.005249, -0.006866, -0.008087, -0.008911, -0.009308, -0.008484, -0.006470, -0.004852, -0.004456, -0.006073, -0.009308, -0.014557, -0.019043, -0.021851, -0.021057, -0.016998, -0.012146, -0.006470, -0.001617, 0.001190, 0.002808, 0.004028, 0.004456, 0.005249, 0.006073, 0.007263, 0.009705, 0.013367, 0.017395, 0.021851, 0.025513, 0.027954, 0.028351, 0.026337, 0.021454, 0.014557, 0.008484, 0.004456, 0.001190, -0.001190, -0.002411, -0.002411, -0.002411, -0.003235, -0.004852, -0.005646, -0.005249, -0.004456, -0.003632, -0.002411, -0.001190, -0.000397, 0.000793, 0.001190, 0.000793, 0.000000, 0.000000, 0.001190, 0.002014, 0.001190, -0.001617, -0.006866, -0.012543, -0.016998, -0.018219, -0.016998, -0.014984, -0.012939, -0.012146, -0.012543, -0.012543, -0.011749, -0.010101, -0.008484, -0.007263, -0.006470, -0.005646, -0.004852, -0.004028, -0.002014, 0.000793, 0.002411, 0.002014, 0.000397, -0.000397, 0.000793, 0.003632, 0.006470, 0.008484, 0.008911, 0.008911, 0.008484, 0.008911, 0.010101, 0.010529, 0.010529, 0.009308, 0.007690, 0.006866, 0.006470, 0.006470, 0.006073, 0.005249, 0.002014, -0.002808, -0.006866, -0.008911, -0.009308, -0.008484, -0.006073, -0.002808, 0.000397, 0.003235, 0.003632, 0.000793, -0.004852, -0.010101, -0.012543, -0.011322, -0.006866, -0.001617, 0.002808, 0.005646, 0.006470, 0.006073, 0.004852, 0.003632, 0.002411, 0.002411, 0.004028, 0.005646, 0.007690, 0.010101, 0.012939, 0.014160, 0.012939, 0.009705, 0.004852, 0.001190, -0.001617, -0.003632, -0.004852, -0.005249, -0.005646, -0.005646, -0.005646, -0.005646, -0.006866, -0.008484, -0.010529, -0.011749, -0.012146, -0.010101, -0.005646, -0.000793, 0.003632, 0.005646, 0.004456, 0.002411, 0.000000, -0.001190, -0.001190, -0.000793, 0.000793, 0.002808, 0.005646, 0.008087, 0.010101, 0.010925, 0.009705, 0.008087, 0.006073, 0.004028, 0.000793, -0.002808, -0.005646, -0.006866, -0.006073, -0.003235, 0.000793, 0.004852, 0.008484, 0.010529, 0.010925, 0.010101, 0.008087, 0.004456, -0.000397, -0.005646, -0.009705, -0.011322, -0.010925, -0.010101, -0.008484, -0.006866, -0.005249, -0.003235, -0.001617, -0.002014, -0.003235, -0.004456, -0.005646, -0.007263, -0.010101, -0.011749, -0.011749, -0.010101, -0.007263, -0.004028, -0.001617, 0.000000, 0.000397, 0.000397, 0.001190, 0.004028, 0.008087, 0.011749, 0.013367, 0.012543, 0.010925, 0.008911, 0.006866, 0.006470, 0.006866, 0.007263, 0.007263, 0.007263, 0.007263, 0.006470, 0.003632, 0.000397, -0.002808, -0.004852, -0.004852, -0.003632, -0.002411, -0.002014, -0.002411, -0.003235, -0.004456, -0.004852, -0.004456, -0.004028, -0.003632, -0.003632, -0.003632, -0.002808, -0.001617, 0.000397, 0.002014, 0.002808, 0.001617, 0.000000, -0.002808, -0.005646, -0.008484, -0.011322, -0.012939, -0.012146, -0.009308, -0.006470, -0.004028, -0.004028, -0.005249, -0.007690, -0.009308, -0.008484, -0.006073, -0.002808, 0.001617, 0.006470, 0.010101, 0.012146, 0.012146, 0.010925, 0.008911, 0.007263, 0.006073, 0.005249, 0.004456, 0.005249, 0.007690, 0.009705, 0.010101, 0.008911, 0.006866, 0.004456, 0.003235, 0.003632, 0.003235, 0.002014, 0.000397, -0.002014, -0.004852, -0.006470, -0.007690, -0.008087, -0.007690, -0.005646, -0.002411, 0.000397, 0.001190, 0.000000, -0.002411, -0.004028, -0.004028, -0.001617, 0.002411, 0.005646, 0.007263, 0.007263, 0.006073, 0.004456, 0.002411, 0.000397, -0.000793, -0.000793, 0.000000, 0.000793, 0.000793, 0.000000, -0.001617, -0.004028, -0.007263, -0.010529, -0.012543, -0.012939, -0.012543, -0.012146, -0.012146, -0.012543, -0.012543, -0.012146, -0.010925, -0.008911, -0.006470, -0.003632, -0.000793, 0.002014, 0.004456, 0.006470, 0.007263, 0.007690, 0.007263, 0.006470, 0.006073, 0.006470, 0.007690, 0.009308, 0.011322, 0.014160, 0.017395, 0.019440, 0.019836, 0.019440, 0.017822, 0.014160, 0.008911, 0.001617, -0.005249, -0.010101, -0.012146, -0.010925, -0.007263, -0.001617, 0.004456, 0.009308, 0.011749, 0.011322, 0.007690, 0.002411, -0.003235, -0.008087, -0.010101, -0.009705, -0.008087, -0.006073, -0.003632, -0.002014, -0.000397, 0.000000, 0.000397, 0.000000, -0.000793, -0.002014, -0.004028, -0.005646, -0.006866, -0.007263, -0.006866, -0.006073, -0.004852, -0.002808, -0.000397, 0.001190, 0.002808, 0.003632, 0.004456, 0.005646, 0.007690, 0.008911, 0.008911, 0.006470, 0.002014, -0.002808, -0.006470, -0.007263, -0.005249, -0.002014, 0.001190, 0.005249, 0.008484, 0.010925, 0.011749, 0.012146, 0.012146, 0.011749, 0.009705, 0.006866, 0.003632, 0.002014, 0.002014, 0.001617, 0.000000, -0.003235, -0.006470, -0.009308, -0.010925, -0.011749, -0.011322, -0.009705, -0.008087, -0.006073, -0.004456, -0.003235, -0.002014, -0.001617, -0.002014, -0.002014, -0.002411, -0.002808, -0.002411, -0.001617, -0.000793, 0.000000, 0.000397, 0.000397, 0.000793, 0.000793, 0.000793, 0.000000, -0.001190, -0.002014, -0.002014, -0.000793, 0.001190, 0.002411, 0.002014, 0.000793, -0.000397, -0.002014, -0.002808, -0.002808, -0.002014, -0.001190, -0.000397, 0.000397, 0.000793, 0.000397, -0.001190, -0.003235, -0.004456, -0.004028, -0.003632, -0.002411, -0.001190, 0.000793, 0.002808, 0.004852, 0.006866, 0.008911, 0.010101, 0.010529, 0.010101, 0.008911, 0.007263, 0.004028, 0.001190, -0.000793, -0.003235, -0.005249, -0.006866, -0.006866, -0.006073, -0.004028, -0.002411, -0.000793, 0.000000, 0.001190, 0.002411, 0.003235, 0.003632, 0.003235, 0.002411, 0.002411, 0.003235, 0.004852, 0.007690, 0.010925, 0.014984, 0.019440, 0.022278, 0.022675, 0.021851, 0.019440, 0.016602, 0.013367, 0.009705, 0.005646, 0.002411, 0.000397, 0.000000, 0.000397, 0.000397, -0.000793, -0.002411, -0.004456, -0.006073, -0.007263, -0.008087, -0.008087, -0.007690, -0.007263, -0.007263, -0.008087, -0.008911, -0.010101, -0.010529, -0.010925, -0.011322, -0.011322, -0.010925, -0.010529, -0.009705, -0.008484, -0.006866, -0.004456, -0.001617, 0.001190, 0.003632, 0.005249, 0.006073, 0.006866, 0.007263, 0.006866, 0.005646, 0.004456, 0.004028, 0.005249, 0.006866, 0.008087, 0.008087, 0.006470, 0.003235, 0.000397, -0.001617, -0.002014, -0.002014, -0.002014, -0.002014, -0.002808, -0.003632, -0.003632, -0.003235, -0.002411, -0.001617, -0.001617, -0.002411, -0.003235, -0.004028, -0.004852, -0.005646, -0.006073, -0.006073, -0.006470, -0.006073, -0.004852, -0.003632, -0.002808, -0.002014, -0.002808, -0.004456, -0.006470, -0.008911, -0.011322, -0.012939, -0.013367, -0.012146, -0.009705, -0.006866, -0.004028, -0.001190, 0.002411, 0.007263, 0.011322, 0.013367, 0.012146, 0.007690, 0.002411, -0.002808, -0.006073, -0.006470, -0.004456, -0.002411, -0.000793, -0.000397, -0.001190, -0.002411, -0.003235, -0.004028, -0.004456, -0.004456, -0.004028, -0.003235, -0.002411, -0.001190, 0.000793, 0.002411, 0.003235, 0.003235, 0.002411, 0.001617, -0.000793, -0.003235, -0.006470, -0.008911, -0.009705, -0.009308, -0.006866, -0.002411, 0.002411, 0.006073, 0.008087, 0.008087, 0.005249, 0.000397, -0.004028, -0.006866, -0.006470, -0.004456, -0.001617, 0.001617, 0.004456, 0.006073, 0.005646, 0.004028, 0.002014, 0.001190, 0.000793, 0.000000, -0.000397, -0.000793, 0.000000, 0.000793, 0.000793, 0.000793, 0.000793, 0.001617, 0.002808, 0.005646, 0.008087, 0.010101, 0.010101, 0.008087, 0.004456, 0.000793, -0.002411, -0.004456, -0.004852, -0.004028, -0.002014, -0.000397, 0.000793, 0.000793, 0.000793, -0.000397, -0.002411, -0.003632, -0.004028, -0.003235, -0.002014, -0.000793, 0.001190, 0.002808, 0.003632, 0.003632, 0.003235, 0.002014, 0.000000, -0.001190, -0.002014, -0.002808, -0.003235, -0.004028, -0.004456, -0.004456, -0.003235, -0.002014, -0.002014, -0.004028, -0.006470, -0.008911, -0.009308, -0.007690, -0.004852, -0.001617, 0.001190, 0.002808, 0.004028, 0.004852, 0.006470, 0.007690, 0.008087, 0.007690, 0.006470, 0.004456, 0.002014, -0.000397, -0.002808, -0.004456, -0.005249, -0.004456, -0.002808, -0.001617, -0.000397, 0.000793, 0.000793, 0.000397, -0.000397, -0.001190, -0.002411, -0.002808, -0.003235, -0.004456, -0.006866, -0.009705, -0.012543, -0.014557, -0.015778, -0.015381, -0.012939, -0.009308, -0.005249, -0.001190, 0.002411, 0.005249, 0.006866, 0.008911, 0.011322, 0.013367, 0.014984, 0.015381, 0.014984, 0.013763, 0.012146, 0.010529, 0.009705, 0.009308, 0.009705, 0.009308, 0.008484, 0.006866, 0.004456, 0.002411, 0.001190, 0.000397, -0.000397, -0.000793, -0.001617, -0.002411, -0.002411, -0.001190, 0.000793, 0.002411, 0.003632, 0.003632, 0.003235, 0.002411, 0.001617, 0.000397, -0.000793, -0.001617, -0.001617, -0.001617, -0.002014, -0.002411, -0.003235, -0.004028, -0.004852, -0.005249, -0.006073, -0.006866, -0.008484, -0.011322, -0.014160, -0.016205, -0.015778, -0.012939, -0.009308, -0.006073, -0.004028, -0.002411, -0.000793, 0.000397, 0.000000, -0.001617, -0.003235, -0.003235, -0.001190, 0.002014, 0.005249, 0.007263, 0.008484, 0.008484, 0.007263, 0.005249, 0.002411, -0.000397, -0.001617, -0.002014, -0.001617, -0.000397, 0.000793, 0.001617, 0.002411, 0.004456, 0.007690, 0.011322, 0.013763, 0.014557, 0.012939, 0.010529, 0.007263, 0.004028, 0.001617, 0.000000, -0.000397, -0.000793, -0.000793, -0.000793, -0.001617, -0.002014, -0.002808, -0.003235, -0.003235, -0.002808, -0.001190, 0.000397, 0.002411, 0.004456, 0.006073, 0.006470, 0.004852, 0.001617, -0.001617, -0.005249, -0.008484, -0.010529, -0.010101, -0.007690, -0.003632, 0.001190, 0.004852, 0.006866, 0.007263, 0.006866, 0.006866, 0.006470, 0.005646, 0.003632, 0.001190, -0.001190, -0.004028, -0.005646, -0.005646, -0.004852, -0.002411, 0.000000, 0.002808, 0.004028, 0.004456, 0.004028, 0.002411, 0.000000, -0.002808, -0.004852, -0.005249, -0.004456, -0.003235, -0.001617, 0.000000, 0.001190, 0.001190, 0.000000, -0.003235, -0.006866, -0.010101, -0.012543, -0.013367, -0.012146, -0.009308, -0.005249, -0.000793, 0.002808, 0.004852, 0.006470, 0.008484, 0.010529, 0.010925, 0.008911, 0.005249, 0.000793, -0.002411, -0.004028, -0.005249, -0.005249, -0.005249, -0.004852, -0.003235, -0.000397, 0.002808, 0.006073, 0.008484, 0.010101, 0.010925, 0.011749, 0.012146, 0.011322, 0.009308, 0.007690, 0.006470, 0.005646, 0.004852, 0.003632, 0.002014, 0.000000, -0.002411, -0.004852, -0.006866, -0.008484, -0.008484, -0.007690, -0.006470, -0.006073, -0.006866, -0.008484, -0.010529, -0.013367, -0.016602, -0.018219, -0.018616, -0.016998, -0.013763, -0.008911, -0.003632, 0.000397, 0.003235, 0.005646, 0.006470, 0.006866, 0.008087, 0.009705, 0.011322, 0.013763, 0.015778, 0.017395, 0.018616, 0.018219, 0.016205, 0.013763, 0.010925, 0.007690, 0.004456, 0.002014, 0.000000, -0.000397, 0.000000, 0.000397, 0.000793, 0.001190, 0.002014, 0.003632, 0.004028, 0.003235, 0.001190, -0.000793, -0.003235, -0.004852, -0.006470, -0.007690, -0.008911, -0.010529, -0.010925, -0.011322, -0.011322, -0.010529, -0.010101, -0.010925, -0.012146, -0.013367, -0.014160, -0.014160, -0.013367, -0.011749, -0.010101, -0.008484, -0.007263, -0.006073, -0.005249, -0.004456, -0.002808, -0.000397, 0.002808, 0.005646, 0.008484, 0.010529, 0.011749, 0.011749, 0.010529, 0.008484, 0.006470, 0.005646, 0.005646, 0.006073, 0.007263, 0.008911, 0.011749, 0.014557, 0.016602, 0.017822, 0.017822, 0.016602, 0.014557, 0.012543, 0.011322, 0.010101, 0.008484, 0.005646, 0.002411, -0.000793, -0.003235, -0.005646, -0.007690, -0.008484, -0.008087, -0.007263, -0.006470, -0.006470, -0.006866, -0.007263, -0.006470, -0.005646, -0.004456, -0.003235, -0.002411, -0.001617, -0.001190, -0.000397, 0.000000, 0.000000, 0.000000, 0.000397, 0.000397, 0.000793, 0.000793, 0.001190, 0.001190, 0.001190, 0.000000, -0.002014, -0.004028, -0.006073, -0.007263, -0.007263, -0.006866, -0.005249, -0.003235, -0.002411, -0.002808, -0.003632, -0.004456, -0.004456, -0.003632, -0.003235, -0.002014, -0.000793, 0.000397, 0.001190, 0.001190, 0.001617, 0.001190, 0.000397, -0.000793, -0.002411, -0.003632, -0.005249, -0.006470, -0.006866, -0.005646, -0.003235, 0.000000, 0.002411, 0.004456, 0.005249, 0.004852, 0.003235, 0.000793, -0.002014, -0.004456, -0.005646, -0.006073, -0.005646, -0.004028, -0.002014, 0.000397, 0.002014, 0.003632, 0.004028, 0.003235, 0.002411, 0.002411, 0.003235, 0.004456, 0.005646, 0.006866, 0.006866, 0.006866, 0.006470, 0.006866, 0.007690, 0.008484, 0.009308, 0.009308, 0.008484, 0.006866, 0.005249, 0.004456, 0.003632, 0.002808, 0.000793, -0.002014, -0.004852, -0.008484, -0.012146, -0.014557, -0.015381, -0.014557, -0.012543, -0.009308, -0.005646, -0.002808, -0.000397, 0.000397, 0.000397, 0.000000, -0.000397, 0.000000, 0.000397, 0.000793, 0.001190, 0.001190, 0.001190, 0.001190, 0.002014, 0.002411, 0.003235, 0.004028, 0.004852, 0.004456, 0.003235, 0.001190, -0.000397, -0.001190, 0.000000, 0.002411, 0.005249, 0.007263, 0.008484, 0.009308, 0.009308, 0.008484, 0.007263, 0.006073, 0.004456, 0.002808, 0.000793, -0.001190, -0.002808, -0.003632, -0.002808, 0.000000, 0.003632, 0.004852, 0.002808, -0.002411, -0.008911, -0.014557, -0.018219, -0.019043, -0.018219, -0.016205, -0.014160, -0.012543, -0.011322, -0.010101, -0.010101, -0.010529, -0.011322, -0.011749, -0.012543, -0.012543, -0.012146, -0.010529, -0.007690, -0.005646, -0.004456, -0.004028, -0.003632, -0.002411, 0.000000, 0.002808, 0.006073, 0.008484, 0.009705, 0.009705, 0.008911, 0.007690, 0.006866, 0.006866, 0.006866, 0.007690, 0.008484, 0.009308, 0.009705, 0.009308, 0.009308, 0.008484, 0.008087, 0.007690, 0.007263, 0.007263, 0.007263, 0.007263, 0.006470, 0.005249, 0.004456, 0.003632, 0.002014, -0.000793, -0.004456, -0.007690, -0.008911, -0.008087, -0.006470, -0.004852, -0.003632, -0.003632, -0.003632, -0.004028, -0.004028, -0.003632, -0.002411, -0.001190, -0.000397, -0.000793, -0.001190, -0.001617, -0.001617, -0.000397, 0.000397, 0.001617, 0.003235, 0.004852, 0.006470, 0.007263, 0.006866, 0.005646, 0.003632, 0.001617, 0.000000, -0.000397, -0.000397, 0.001190, 0.002014, 0.002014, 0.000397, -0.001190, -0.001190, -0.000397, 0.001190, 0.002411, 0.002808, 0.001617, -0.000397, -0.003235, -0.005249, -0.006073, -0.005646, -0.004456, -0.003632, -0.003235, -0.002808, -0.002014, 0.000000, 0.001190, 0.001617, 0.000793, -0.000397, -0.001617, -0.002808, -0.002808, -0.001617, 0.001190, 0.004028, 0.006470, 0.007690, 0.008087, 0.008087, 0.007263, 0.005646, 0.004028, 0.002808, 0.002808, 0.002808, 0.002808, 0.002411, 0.001190, -0.000397, -0.001617, -0.002014, -0.001617, -0.000793, 0.000000, 0.000793, 0.002014, 0.002411, 0.001617, 0.000397, -0.001190, -0.002411, -0.003632, -0.004028, -0.004456, -0.004852, -0.004456, -0.004028, -0.002808, -0.001617, -0.000793, -0.000793, -0.002014, -0.004456, -0.006866, -0.008911, -0.008911, -0.007690, -0.004852, -0.002014, 0.000397, 0.001190, 0.001190, 0.001190, 0.001617, 0.001617, 0.001190, 0.000397, -0.001190, -0.002014, -0.002411, -0.001617, -0.000793, 0.000000, 0.000793, 0.001190, 0.002014, 0.003235, 0.004852, 0.005249, 0.004852, 0.004852, 0.004028, 0.003235, 0.002808, 0.002808, 0.003632, 0.005646, 0.008484, 0.011322, 0.013367, 0.014557, 0.014160, 0.012939, 0.010925, 0.008087, 0.004852, 0.001617, -0.000793, -0.001617, -0.001617, -0.000793, -0.000397, -0.000793, -0.001190, -0.001617, -0.002014, -0.002014, -0.003235, -0.005646, -0.008087, -0.010101, -0.011322, -0.011749, -0.011322, -0.010925, -0.010101, -0.008484, -0.006073, -0.004028, -0.002014, -0.000397, 0.000793, 0.002014, 0.003235, 0.004028, 0.003632, 0.002411, 0.001190, 0.000397, -0.000793, -0.001617, -0.002411, -0.002808, -0.002411, -0.000397, 0.001617, 0.003235, 0.004028, 0.004028, 0.003632, 0.003632, 0.003632, 0.003632, 0.004028, 0.003632, 0.003632, 0.003235, 0.002411, 0.001190, 0.000397, 0.000000, 0.000000, 0.000793, 0.002014, 0.003235, 0.003632, 0.002808, 0.000397, -0.002411, -0.004456, -0.005249, -0.004852, -0.004456, -0.003235, -0.002014, -0.000793, -0.000397, -0.000397, -0.001190, -0.002411, -0.003235, -0.003235, -0.002411, -0.000793, 0.001190, 0.003235, 0.004852, 0.006866, 0.008484, 0.009308, 0.008484, 0.006470, 0.004456, 0.002808, 0.002411, 0.002411, 0.002411, 0.002411, 0.001190, -0.000397, -0.002808, -0.005646, -0.007690, -0.009308, -0.010529, -0.011322, -0.012146, -0.011749, -0.010529, -0.008484, -0.006866, -0.006073, -0.006470, -0.006866, -0.007263, -0.006073, -0.003632, -0.000397, 0.002808, 0.004852, 0.006073, 0.005646, 0.004456, 0.002808, 0.001617, 0.001190, 0.002014, 0.003235, 0.004852, 0.006073, 0.006470, 0.006073, 0.005249, 0.004028, 0.002014, 0.000000, -0.001617, -0.002411, -0.002014, -0.000397, 0.001617, 0.003235, 0.004852, 0.006470, 0.007690, 0.008087, 0.008484, 0.008484, 0.008087, 0.006470, 0.004028, 0.000397, -0.004028, -0.008087, -0.010529, -0.010529, -0.008484, -0.006073, -0.004028, -0.002014, -0.000397, 0.000397, 0.000793, 0.001190, 0.001190, 0.000793, -0.000397, -0.001190, -0.000793, 0.000000, 0.000793, 0.001190, 0.000397, 0.000397, 0.000397, 0.000793, 0.001190, 0.001190, 0.001190, 0.000793, 0.000397, 0.000397, 0.001190, 0.001617, 0.002014, 0.002014, 0.001190, -0.000397, -0.002014, -0.003235, -0.003632, -0.003235, -0.002808, -0.002411, -0.002411, -0.003235, -0.003632, -0.004028, -0.004028, -0.002808, -0.000793, 0.001617, 0.004028, 0.006470, 0.007690, 0.008087, 0.006470, 0.004028, 0.000793, -0.001617, -0.004028, -0.005646, -0.007263, -0.008911, -0.010529, -0.011322, -0.011749, -0.012146, -0.010925, -0.008911, -0.005646, -0.003235, -0.001617, 0.000000, 0.001190, 0.002808, 0.003632, 0.003235, 0.002411, 0.000793, 0.000000, 0.000000, 0.000397, 0.001617, 0.002411, 0.002411, 0.001190, 0.000000, -0.000793, -0.001190, -0.000397, 0.000397, 0.002411, 0.004456, 0.006073, 0.006866, 0.007263, 0.006866, 0.006866, 0.006866, 0.007263, 0.007690, 0.008087, 0.007690, 0.006470, 0.004852, 0.002411, 0.000000, -0.001617, -0.002808, -0.002808, -0.002014, -0.000397, 0.001190, 0.002808, 0.003235, 0.002808, 0.001190, -0.000397, -0.001190, -0.001617, -0.002014, -0.003632, -0.005646, -0.007263, -0.008484, -0.008911, -0.009308, -0.009308, -0.008484, -0.007690, -0.007263, -0.006866, -0.006470, -0.006470, -0.007263, -0.008484, -0.008484, -0.007263, -0.004028, 0.000000, 0.003235, 0.005249, 0.006073, 0.005249, 0.004028, 0.002411, 0.001190, 0.000793, 0.001190, 0.002808, 0.004456, 0.005646, 0.006470, 0.006073, 0.005249, 0.003632, 0.002411, 0.002014, 0.002014, 0.002411, 0.002411, 0.002808, 0.003235, 0.003235, 0.002411, 0.001617, 0.000000, -0.001190, -0.002014, -0.001617, -0.001617, -0.001617, -0.002411, -0.003235, -0.004456, -0.006073, -0.007263, -0.008087, -0.008484, -0.008484, -0.007690, -0.006073, -0.004456, -0.002808, -0.000793, 0.001190, 0.003235, 0.004852, 0.006073, 0.005646, 0.003235, 0.000000, -0.003632, -0.005646, -0.005249, -0.002808, 0.000397, 0.003235, 0.005646, 0.006470, 0.006073, 0.005249, 0.004028, 0.002411, 0.000793, -0.000397, -0.001190, -0.001190, -0.000397, 0.000793, 0.002014, 0.002411, 0.002014, 0.001190, 0.000000, -0.000793, -0.001190, -0.000793, -0.000397, 0.000397, 0.000793, 0.001190, 0.001190, 0.000000, -0.001617, -0.003235, -0.004028, -0.003235, -0.000793, 0.001617, 0.003632, 0.004456, 0.004028, 0.002808, 0.001617, 0.001190, 0.001617, 0.002014, 0.002014, 0.001617, 0.000397, -0.001617, -0.004028, -0.005646, -0.006866, -0.006866, -0.006866, -0.005646, -0.004028, -0.002411, -0.000793, 0.000000, 0.000397, 0.000793, 0.000793, 0.000397, -0.000397, -0.001617, -0.002411, -0.002808, -0.002014, -0.001190, -0.000793, 0.000397, 0.002014, 0.004028, 0.006073, 0.008087, 0.009308, 0.009705, 0.010101, 0.010101, 0.009705, 0.009308, 0.008484, 0.007263, 0.005249, 0.002808, 0.000397, -0.002014, -0.003235, -0.004456, -0.004852, -0.004852, -0.004852, -0.005249, -0.005249, -0.005249, -0.005646, -0.006470, -0.008087, -0.009308, -0.010101, -0.009705, -0.007690, -0.004852, -0.002014, 0.000793, 0.002411, 0.003235, 0.002808, 0.002411, 0.002411, 0.003235, 0.005249, 0.007690, 0.008087, 0.006866, 0.004852, 0.002014, 0.000000, -0.000793, -0.000397, 0.000397, 0.002014, 0.003632, 0.005249, 0.006073, 0.006470, 0.006073, 0.005249, 0.004028, 0.003235, 0.002411, 0.002014, 0.002411, 0.003235, 0.004028, 0.004028, 0.004028, 0.004456, 0.004852, 0.004852, 0.004028, 0.002411, 0.000793, -0.001190, -0.002808, -0.002411, -0.001190, 0.000000, 0.000793, 0.000000, -0.002014, -0.004028, -0.006073, -0.007263, -0.008087, -0.008484, -0.007690, -0.006073, -0.003632, -0.002014, -0.001190, -0.001190, -0.001617, -0.002014, -0.002808, -0.003632, -0.004028, -0.002808, -0.000397, 0.002014, 0.004028, 0.004852, 0.004852, 0.004852, 0.004456, 0.003632, 0.002411, 0.000793, -0.000397, -0.001617, -0.002014, -0.001617, -0.000397, 0.001190, 0.002014, 0.002411, 0.002808, 0.003235, 0.003235, 0.002411, 0.001617, 0.000793, 0.000793, 0.001617, 0.002808, 0.004456, 0.005646, 0.006866, 0.007263, 0.006470, 0.004852, 0.002014, -0.001190, -0.003632, -0.004852, -0.004852 };

static const Material materials[NUM_MATERIALS] = { Material(8940.f, 123.4f * 1e9f, 0.34f, ofColor(255, 0, 0, 255)),
                                                   Material(2700.f, 72.f * 1e9f, 0.19f, ofColor(0, 255, 0, 255)),
                                                   Material(2700.f, 62.f * 1e9f, 0.20f, ofColor(0, 0, 255, 255)),
                                                   Material(1200.f, 2.4f * 1e9f, 0.37f, ofColor(255, 0, 255, 255)) };

static const string sphereObjFileName = "C:/Users/wangyix/Desktop/GitHub/CS448Z/of/apps/myApps/Particles/models/sphere/sphere.obj";
static const string rodObjFileName = "C:/Users/wangyix/Desktop/GitHub/CS448Z/of/apps/myApps/Particles/models/rod/rod.obj";
static const string groundObjFileName = "C:/Users/wangyix/Desktop/GitHub/CS448Z/of/apps/myApps/Particles/models/ground/ground.obj";


static int secondsToSamples(float t) {
    return ((int)(t * AUDIO_SAMPLE_RATE)) * CHANNELS;
}

//--------------------------------------------------------------
void ofApp::setup(){
    windowResized(ofGetWidth(), ofGetHeight());

    // initialize rigid bodies
    //bodies.emplace_back(sphereObjFileName, materials[0], 1.f);
    //bodies.emplace_back(rodObjFileName, materials[0], 40.f);
    bodies.emplace_back(groundObjFileName, materials[0], 0.2f);
    bodies[0].x = 0.5f * (pMin + pMax) + ofVec3f(0.f, 2.f, 0.f);
    bodies[0].rotate(PI / 6.f, ofVec3f(0.f, 0.f, 1.f));
    //bodies[0].rotate(-PI / 6.f, ofVec3f(1.f, 0.f, 0.f));

    // initialize light
    ofSetSmoothLighting(true);
    pointLight.setDiffuseColor(ofFloatColor(.85, .85, .55));
    pointLight.setSpecularColor(ofFloatColor(1.f, 1.f, 1.f));

    gravity = ofVec3f(0.f, GRAVITY_MAG, 0.f);
    attract = false;

    listenPos = ofVec3f(0.5f * (pMin.x + pMax.x), 0.5f * (pMin.y + pMax.y), BOX_ZMAX);

    ofSoundStreamSetup(CHANNELS, 0, AUDIO_SAMPLE_RATE, 256, 4);
    ofSetFrameRate(60);
}

//--------------------------------------------------------------
void ofApp::exit() {
}

enum WALL_ID{ NONE=0, XMIN=1, XMAX=2, YMIN=3, YMAX=4, ZMIN=5, ZMAX=6 };

int ofApp::particleCollideWall(const ofVec3f& x, const ofVec3f& v, float tMax, float* tc) {
    assert(tMax > 0.f);
    *tc = tMax;
    int id = NONE;
    if (v.x > 0.f) {
        float t = (pMax.x - x.x) / v.x;
        if (0.f < t && t < *tc) {
            *tc = t;
            id = XMAX;
        }
    } else if (v.x < 0.f) {
        float t = (pMin.x - x.x) / v.x;
        if (0.f < t && t < *tc) {
            *tc = t;
            id = XMIN;
        }
    }
    if (v.y > 0.f) {
        float t = (pMax.y - x.y) / v.y;
        if (0.f < t && t < *tc) {
            *tc = t;
            id = YMAX;
        }
    } else if (v.y < 0.f) {
        float t = (pMin.y - x.y) / v.y;
        if (0.f < t && t < *tc) {
            *tc = t;
            id = YMIN;
        }
    }
    if (v.z > 0.f) {
        float t = (pMax.z - x.z) / v.z;
        if (0.f < t && t < *tc) {
            *tc = t;
            id = ZMAX;
        }
    } else if (v.z < 0.f) {
        float t = (pMin.z - x.z) / v.z;
        if (0.f < t && t < *tc) {
            *tc = t;
            id = ZMIN;
        }
    }
    return id;
}

vector<ofVec3f> collisions;

//--------------------------------------------------------------
void ofApp::update(){
//if (!collisions.empty()) { return; }
    float dt = ofGetLastFrameTime();
    
    // apply non-rotational forces to bodies
    for (RigidBody& body : bodies) {
        body.v += gravity * dt;
        body.P = body.m * body.v;
    }
static float count = 0.f;
count += dt;
if (count > 1.f) {
    count = 0.f;
    collisions.clear();
}

    // compute collisions of vertices against walls
    for (RigidBody& body : bodies) {


        float dtProcessed = 0.f;
        while (dtProcessed < dt) {
ofVec3f riBody_c;
ofVec3f xi_c;
            ofVec3f ri_c;                               // ri of the vertex that collides
            ofVec3f vi_c;
            float dt_c = dt - dtProcessed;  // collision will occur dt_c from now
            int wallId = NONE;

            for (int i = 0; i < body.mesh.getNumVertices(); i++) {
                ofVec3f ri = body.R * body.mesh.getVertex(i);
                ofVec3f xi = body.x + ri;
                ofVec3f vi = body.v + body.w.crossed(ri);

                float t;
                int id = particleCollideWall(xi, vi, dt - dtProcessed, &t);
                if (id != NONE && t < dt_c) {
riBody_c = body.mesh.getVertex(i);
xi_c = xi;
                    dt_c = t;
                    wallId = id;
                    ri_c = ri;
                    vi_c = vi;
                }
            }
            assert(dt_c > 0.f);
            body.step(dt_c);

            // compute impulse imparted by collision at this vertex, if any
            // accumulate effect of impulse into dP, dL
            ofVec3f n;
            switch (wallId) {
            case XMIN:
                n = ofVec3f(1.f, 0.f, 0.f);
                break;
            case XMAX:
                n = ofVec3f(-1.f, 0.f, 0.f);
                break;
            case YMIN:
                n = ofVec3f(0.f, 1.f, 0.f);
                break;
            case YMAX:
                n = ofVec3f(0.f, -1.f, 0.f);
                break;
            case ZMIN:
                n = ofVec3f(0.f, 0.f, 1.f);
                break;
            case ZMAX:
                n = ofVec3f(0.f, 0.f, -1.f);
                break;
            default:
                break;
            }
            
            if (wallId != NONE) {
collisions.push_back(xi_c);
                float e = 0.2f;
                float j = -(1 + e)*vi_c.dot(n) /
                    (1.f / body.m + (body.IInv*(ri_c.crossed(n)).crossed(ri_c)).dot(n));
                assert(j > 0.f);

                // update linear, angular momentum with impulse
                body.P += j*n;
                body.L += ri_c.crossed(j*n);
                // update linear, angular velocities from momentum
                body.v = body.P / body.m;
                body.w = body.IInv * body.L;
            } 

            dtProcessed += dt_c;
        }

    }

    float tempAudioBuffer[CHANNELS * AUDIO_SAMPLE_RATE];
    memset(tempAudioBuffer, 0, CHANNELS * AUDIO_SAMPLE_RATE * sizeof(float));
    int audioStart = CHANNELS * AUDIO_SAMPLE_RATE;
    int audioEnd = -1;

    // process and add audio samples if any were produced this frame
    if (audioEnd - audioStart > 0) {
        audioBufferLock.lock();
        int additionalCapcityNeeded = audioEnd - audioBuffer.size();
        if (additionalCapcityNeeded > 0) {
            audioBuffer.pushZeros(additionalCapcityNeeded);
            audioEnd = audioBuffer.size();  // in case audioBuffer couldn't push the requested amount of zeros 
        }
        auto iter = audioBuffer.at(audioStart);
        for (int i = audioStart; i < audioEnd; i++) {
            *iter += tempAudioBuffer[i];    // reverbAudioBuffer[i];
            ++iter;
        }
        audioBufferLock.unlock();
    }
}

//--------------------------------------------------------------
void ofApp::draw(){
    ofBackground(0);
    
    ofEnableLighting();
    pointLight.enable();

    ofEnableDepthTest();
    
    ofSetColor(200, 200, 200);
    leftWall.draw();
    rightWall.draw();
    backWall.draw();
    topWall.draw();
    bottomWall.draw();
    
    for (int i = 0; i < bodies.size(); i++) {
        ofSetColor(bodies[i].material.color);
        ofPushMatrix();
        //ofScale(PIXELS_PER_METER, PIXELS_PER_METER, PIXELS_PER_METER);
        //ofTranslate(bodies[i].x);
        const ofMatrix3x3& R = bodies[i].R;
        const ofVec3f& T = bodies[i].x;
        ofMatrix4x4 objToWorld(R.a, R.d, R.g, 0.f,
                               R.b, R.e, R.h, 0.f,
                               R.c, R.f, R.i, 0.f,
                               T.x, T.y, T.z, 1.f / PIXELS_PER_METER);
        ofLoadMatrix(objToWorld * viewMatrix);
        bodies[i].mesh.draw();
        ofPopMatrix();
    }

    ofSetColor(0, 255, 0);
    for (const ofVec3f& c : collisions) {
        ofIcoSpherePrimitive sphere(0.3f * PIXELS_PER_METER, 1);
        sphere.setPosition(c * PIXELS_PER_METER);
        sphere.draw();
    }

    ofDisableLighting();
    ofSetColor(255, 255, 255);
    ofDrawBitmapString(ofToString(ofGetFrameRate()) + "fps", 10, 15);
}

//--------------------------------------------------------------
void ofApp::audioOut(float* output, int bufferSize, int nChannels) {
    audioBufferLock.lock();
    int samplesPopped = audioBuffer.pop(output, bufferSize * CHANNELS);
    audioBufferLock.unlock();
    int samplesRemaining = CHANNELS * bufferSize - samplesPopped;
    if (samplesRemaining > 0) {
        memset(&output[samplesPopped], 0, samplesRemaining * sizeof(float));
    }
}

//--------------------------------------------------------------
void ofApp::keyPressed(int key){
    switch (key) {
    case '1':
        bodies[0].x.x -= 1.f;
        break;
    case '2':
        bodies[0].x.x += 1.f;
        break;
    case '3':
        bodies[0].x.y -= 1.f;
        break;
    case '4':
        bodies[0].x.y += 1.f;
        break;
    case '5':
        bodies[0].x.z -= 1.f;
        break;
    case '6':
        bodies[0].x.z += 1.f;
        break;
    default:
        break;
    }
}

//--------------------------------------------------------------
void ofApp::keyReleased(int key){
    switch (key) {
    case OF_KEY_LEFT:
        gravity = ofVec3f(-GRAVITY_MAG, 0.f, 0.f);
        break;
    case OF_KEY_RIGHT:
        gravity = ofVec3f(GRAVITY_MAG, 0.f, 0.f);
        break;
    case OF_KEY_UP:
        gravity = ofVec3f(0.f, -GRAVITY_MAG, 0.f);
        break;
    case OF_KEY_DOWN:
        gravity = ofVec3f(0.f, GRAVITY_MAG, 0.f);
        break;
    default:
        break;
    }
}

//--------------------------------------------------------------
void ofApp::mouseMoved(int x, int y ){

}

//--------------------------------------------------------------
void ofApp::mouseDragged(int x, int y, int button){
    attractPos = ofVec3f(x / PIXELS_PER_METER, y / PIXELS_PER_METER, 0.5f * (BOX_ZMIN + BOX_ZMAX));
}

//--------------------------------------------------------------
void ofApp::mousePressed(int x, int y, int button){
    attract = true;
    attractPos = ofVec3f(x / PIXELS_PER_METER, y / PIXELS_PER_METER, 0.5f * (BOX_ZMIN + BOX_ZMAX));
}

//--------------------------------------------------------------
void ofApp::mouseReleased(int x, int y, int button){
    attract = false;
}

//--------------------------------------------------------------
void ofApp::windowResized(int w, int h){
    ofSetupScreenPerspective(w, h, 60.f, BOX_ZMAX * PIXELS_PER_METER, BOX_ZMIN * PIXELS_PER_METER);
    viewMatrix = ofGetCurrentMatrix(OF_MATRIX_MODELVIEW);

    pMin.x = 0.f;
    pMax.x = w / PIXELS_PER_METER;
    pMin.y = 0.f;
    pMax.y = h / PIXELS_PER_METER;
    pMin.z = BOX_ZMIN;
    pMax.z = BOX_ZMAX;

    pointLight.setPosition(w / 2, 10.f, 0.5f*(BOX_ZMIN + BOX_ZMAX)*PIXELS_PER_METER);

    // initialize walls
    leftWall = ofPlanePrimitive((BOX_ZMAX - BOX_ZMIN)*PIXELS_PER_METER, h, 8, 8);
    rightWall = leftWall;
    leftWall.setPosition(0.f, h / 2, 0.5f*(BOX_ZMIN + BOX_ZMAX)*PIXELS_PER_METER);
    leftWall.rotate(90.f, 0.f, 1.f, 0.f);
    rightWall.setPosition(w, h / 2, 0.5f*(BOX_ZMIN + BOX_ZMAX)*PIXELS_PER_METER);
    rightWall.rotate(-90.f, 0.f, 1.f, 0.f);

    backWall = ofPlanePrimitive(w, h, 8, 8);
    backWall.setPosition(w / 2, h / 2, BOX_ZMIN*PIXELS_PER_METER);

    topWall = ofPlanePrimitive(w, (BOX_ZMAX - BOX_ZMIN)*PIXELS_PER_METER, 8, 8);
    bottomWall = topWall;
    topWall.setPosition(w / 2, 0.f, 0.5f*(BOX_ZMIN + BOX_ZMAX)*PIXELS_PER_METER);
    topWall.rotate(-90.f, 1.f, 0.f, 0.f);
    bottomWall.setPosition(w / 2, h, 0.5f*(BOX_ZMIN + BOX_ZMAX)*PIXELS_PER_METER);
    bottomWall.rotate(90.f, 1.f, 0.f, 0.f);
}

//--------------------------------------------------------------
void ofApp::gotMessage(ofMessage msg){

}

//--------------------------------------------------------------
void ofApp::dragEvent(ofDragInfo dragInfo){ 

}
