#include "ofApp.h"
#include <assert.h>
#include <algorithm>


static const float wav[WAV_SAMPLES] = { 0.000397, 0.002014, 0.006073, 0.011749, 0.018616, 0.026337, 0.032806, 0.038483, 0.041718, 0.044159, 0.044952, 0.044952, 0.044556, 0.043732, 0.043335, 0.042542, 0.040894, 0.038086, 0.034027, 0.029572, 0.025116, 0.021454, 0.019440, 0.018219, 0.016205, 0.015381, 0.015381, 0.015381, 0.014160, 0.011322, 0.006866, 0.002808, -0.000793, -0.002808, -0.002808, -0.000793, 0.000397, 0.000000, -0.000793, -0.002014, -0.002808, -0.002014, 0.000397, 0.005646, 0.010925, 0.010925, 0.004456, -0.008087, -0.024689, -0.040497, -0.051453, -0.056702, -0.058319, -0.059540, -0.062775, -0.068054, -0.072510, -0.074951, -0.073730, -0.068878, -0.059143, -0.044952, -0.030365, -0.018219, -0.010529, -0.007263, -0.008087, -0.010101, -0.011749, -0.011749, -0.008911, -0.004456, 0.000397, 0.005249, 0.010529, 0.016998, 0.021851, 0.025909, 0.028748, 0.029572, 0.029968, 0.031982, 0.034027, 0.033203, 0.030365, 0.028748, 0.028748, 0.028748, 0.028351, 0.027954, 0.026337, 0.021454, 0.014160, 0.008087, 0.004028, 0.000000, -0.006073, -0.013367, -0.021454, -0.029968, -0.037659, -0.044952, -0.049408, -0.050629, -0.048187, -0.043335, -0.036865, -0.028748, -0.022278, -0.017822, -0.013367, -0.010925, -0.011749, -0.014160, -0.015381, -0.014557, -0.011322, -0.006470, -0.002411, 0.000000, 0.001190, 0.003632, 0.009308, 0.016602, 0.023071, 0.025909, 0.022278, 0.012543, 0.002014, -0.004028, -0.000793, 0.009705, 0.022278, 0.031586, 0.035248, 0.031586, 0.022675, 0.013367, 0.008087, 0.007263, 0.008484, 0.010529, 0.011322, 0.009308, 0.005249, 0.000793, -0.002014, -0.002014, 0.000793, 0.008087, 0.018219, 0.027130, 0.029968, 0.026337, 0.017395, 0.004456, -0.011322, -0.027527, -0.037659, -0.040100, -0.035248, -0.025513, -0.015778, -0.009308, -0.006866, -0.007690, -0.009705, -0.010925, -0.011322, -0.010101, -0.007690, -0.005646, -0.004852, -0.005249, -0.004456, 0.000397, 0.008087, 0.015381, 0.021851, 0.025116, 0.025513, 0.025116, 0.023895, 0.019836, 0.012543, 0.002411, -0.007263, -0.015778, -0.022278, -0.025116, -0.024292, -0.020660, -0.015381, -0.009705, -0.003632, 0.000397, 0.001617, 0.001190, 0.000397, 0.000000, 0.002014, 0.005249, 0.006073, 0.003235, -0.001190, -0.004852, -0.005646, -0.005249, -0.003235, 0.001190, 0.007690, 0.014557, 0.020660, 0.022278, 0.019440, 0.013367, 0.007263, 0.003632, 0.001190, -0.000793, -0.002411, -0.002014, 0.001190, 0.005249, 0.009705, 0.015381, 0.021454, 0.024292, 0.023071, 0.019440, 0.014557, 0.008087, -0.001190, -0.010529, -0.017395, -0.020233, -0.018616, -0.014160, -0.010925, -0.009705, -0.010529, -0.010101, -0.006470, -0.001617, 0.001190, 0.002808, 0.004028, 0.005646, 0.006866, 0.007263, 0.008087, 0.009308, 0.011322, 0.014160, 0.015381, 0.013763, 0.011749, 0.012146, 0.013763, 0.014557, 0.014160, 0.014160, 0.016205, 0.018219, 0.018616, 0.016205, 0.010925, 0.004028, -0.002808, -0.008087, -0.010925, -0.012146, -0.012543, -0.011749, -0.009308, -0.007690, -0.008484, -0.012146, -0.014984, -0.014984, -0.011322, -0.006073, -0.004028, -0.006866, -0.012543, -0.017822, -0.020660, -0.019440, -0.016205, -0.012939, -0.009705, -0.003235, 0.004028, 0.010925, 0.023499, 0.049835, 0.097626, 0.169769, 0.278748, 0.455811, 0.658417, 0.743500, 0.610992, 0.275909, -0.170166, -0.597229, -0.892609, -1.000000, -0.927460, -0.728912, -0.478119, -0.242279, -0.067657, 0.027954, 0.051025, 0.026337, -0.017395, -0.056702, -0.074951, -0.066833, -0.034821, 0.012543, 0.065216, 0.113434, 0.148682, 0.166931, 0.168945, 0.158417, 0.140167, 0.119110, 0.099243, 0.082642, 0.072113, 0.066437, 0.064423, 0.065216, 0.067261, 0.070496, 0.072510, 0.070892, 0.064423, 0.055084, 0.044159, 0.031982, 0.020660, 0.011322, 0.002411, -0.006866, -0.015381, -0.022278, -0.025513, -0.024689, -0.021057, -0.017395, -0.015778, -0.018219, -0.023499, -0.029968, -0.035645, -0.038879, -0.037262, -0.031189, -0.022278, -0.012543, -0.003632, 0.003235, 0.007690, 0.008087, 0.005249, 0.000793, -0.005249, -0.012543, -0.018219, -0.019836, -0.015778, -0.006470, 0.004028, 0.014160, 0.021454, 0.024292, 0.023071, 0.018616, 0.011322, 0.003235, -0.002411, -0.004456, -0.002014, 0.002808, 0.008484, 0.011749, 0.010925, 0.006470, -0.000397, -0.006866, -0.008484, -0.006866, -0.004028, -0.000397, 0.003235, 0.006073, 0.008087, 0.010101, 0.011749, 0.011749, 0.010101, 0.008484, 0.007263, 0.006470, 0.007263, 0.008911, 0.010925, 0.013367, 0.015381, 0.014557, 0.011322, 0.007690, 0.007263, 0.010101, 0.014160, 0.016602, 0.016602, 0.014160, 0.011322, 0.006866, 0.001617, -0.004028, -0.009308, -0.012543, -0.013367, -0.012939, -0.011749, -0.011749, -0.014160, -0.018616, -0.023895, -0.028351, -0.031189, -0.031982, -0.031189, -0.029572, -0.027954, -0.025513, -0.021454, -0.014984, -0.008911, -0.004852, -0.003632, -0.004456, -0.007690, -0.011749, -0.016998, -0.022675, -0.025513, -0.023071, -0.016602, -0.009308, -0.002808, 0.001617, 0.003235, 0.002014, 0.001617, 0.004456, 0.011322, 0.019836, 0.029968, 0.039276, 0.046173, 0.049011, 0.048615, 0.046173, 0.042938, 0.039703, 0.037262, 0.036438, 0.034821, 0.031982, 0.027130, 0.018219, 0.005249, -0.009308, -0.022675, -0.032410, -0.038086, -0.041321, -0.040894, -0.038879, -0.036041, -0.031586, -0.025513, -0.017395, -0.008911, -0.002014, 0.000000, -0.003632, -0.008911, -0.014557, -0.021057, -0.025116, -0.025513, -0.022675, -0.017395, -0.011322, -0.004852, 0.001617, 0.007690, 0.011322, 0.011322, 0.009308, 0.007263, 0.004852, 0.004456, 0.004852, 0.004028, 0.001617, -0.002014, -0.006866, -0.014160, -0.021057, -0.023071, -0.019440, -0.012146, -0.004456, 0.001617, 0.002808, -0.001617, -0.010925, -0.023071, -0.032806, -0.038086, -0.036438, -0.026733, -0.009308, 0.009705, 0.022278, 0.025513, 0.020660, 0.010529, -0.001190, -0.011322, -0.015778, -0.015778, -0.010925, -0.002411, 0.006073, 0.010101, 0.010101, 0.006866, 0.002808, 0.000000, -0.000397, 0.002411, 0.007263, 0.012939, 0.018219, 0.021057, 0.021057, 0.016998, 0.009308, 0.001617, -0.002808, -0.002808, 0.003235, 0.012543, 0.021057, 0.026337, 0.027527, 0.023895, 0.019043, 0.015381, 0.015778, 0.019043, 0.021851, 0.023499, 0.023499, 0.021454, 0.016602, 0.011749, 0.006073, 0.000397, -0.005646, -0.012543, -0.019836, -0.026733, -0.031189, -0.033203, -0.033630, -0.031982, -0.027954, -0.024689, -0.022278, -0.020233, -0.018616, -0.016998, -0.016205, -0.018219, -0.021454, -0.025513, -0.029968, -0.033203, -0.034027, -0.032806, -0.028748, -0.022278, -0.014557, -0.004852, 0.004852, 0.014160, 0.021454, 0.026337, 0.030365, 0.031982, 0.030792, 0.028748, 0.024689, 0.020233, 0.018616, 0.019440, 0.021057, 0.021057, 0.018616, 0.014160, 0.009308, 0.004456, 0.002411, 0.003632, 0.008087, 0.013367, 0.015381, 0.013763, 0.010529, 0.004028, -0.003632, -0.011322, -0.016205, -0.017395, -0.015381, -0.012146, -0.008911, -0.004852, -0.000793, 0.002808, 0.005249, 0.004456, 0.001190, -0.001190, -0.002808, -0.003632, -0.004456, -0.003235, 0.002014, 0.009308, 0.015381, 0.018219, 0.019043, 0.019043, 0.018616, 0.016602, 0.012543, 0.009308, 0.006866, 0.006470, 0.009308, 0.015381, 0.023499, 0.030365, 0.034821, 0.036438, 0.034027, 0.025116, 0.011322, -0.004028, -0.016602, -0.024689, -0.027527, -0.027527, -0.025513, -0.021454, -0.016602, -0.013763, -0.013367, -0.014984, -0.015778, -0.014160, -0.009308, -0.003632, -0.000397, 0.000793, 0.000793, -0.000397, -0.001190, 0.000000, 0.005249, 0.012543, 0.018219, 0.021057, 0.023499, 0.027130, 0.032806, 0.036438, 0.034821, 0.027527, 0.017395, 0.007690, 0.002808, 0.004852, 0.011749, 0.019043, 0.023895, 0.024689, 0.018219, 0.007690, -0.003632, -0.013763, -0.022675, -0.028351, -0.029968, -0.028748, -0.025116, -0.019836, -0.015381, -0.013367, -0.013763, -0.016602, -0.020660, -0.023895, -0.023499, -0.021057, -0.016998, -0.014557, -0.014557, -0.017395, -0.021057, -0.022675, -0.022278, -0.019836, -0.015381, -0.009308, -0.004028, 0.001190, 0.005646, 0.008087, 0.008911, 0.010101, 0.013367, 0.019836, 0.027954, 0.034424, 0.036041, 0.032806, 0.025909, 0.017822, 0.009308, 0.001190, -0.005646, -0.011322, -0.015778, -0.019043, -0.020233, -0.017822, -0.012543, -0.006866, -0.003235, -0.002411, -0.006470, -0.014160, -0.023499, -0.029144, -0.029968, -0.025909, -0.018616, -0.009308, 0.001617, 0.013367, 0.024689, 0.034424, 0.042114, 0.048187, 0.052246, 0.054688, 0.056702, 0.058319, 0.056702, 0.050232, 0.039276, 0.026733, 0.014984, 0.006073, 0.000000, -0.003632, -0.006073, -0.007263, -0.008087, -0.008911, -0.010529, -0.012543, -0.014160, -0.014557, -0.012939, -0.011322, -0.011322, -0.012939, -0.016998, -0.021454, -0.024689, -0.025909, -0.025513, -0.023895, -0.022675, -0.022278, -0.021454, -0.020660, -0.018219, -0.012939, -0.006470, 0.000397, 0.005249, 0.006866, 0.007263, 0.006470, 0.004028, 0.000793, -0.001617, -0.002808, -0.002411, -0.001617, 0.001190, 0.005646, 0.010101, 0.014160, 0.016602, 0.014984, 0.008911, -0.002014, -0.015778, -0.027954, -0.034821, -0.034424, -0.028351, -0.016998, -0.002014, 0.011749, 0.019043, 0.019043, 0.013763, 0.006470, -0.001617, -0.008911, -0.014557, -0.016998, -0.016205, -0.013763, -0.011749, -0.011322, -0.013763, -0.016998, -0.019836, -0.019440, -0.016602, -0.012146, -0.006866, -0.001617, 0.001617, 0.000793, -0.002411, -0.004456, -0.003632, -0.000397, 0.003632, 0.008087, 0.011322, 0.012543, 0.012939, 0.012543, 0.012146, 0.013367, 0.016998, 0.020660, 0.023499, 0.024292, 0.024292, 0.023071, 0.022278, 0.021851, 0.021851, 0.021454, 0.019043, 0.014557, 0.010925, 0.009705, 0.010925, 0.011322, 0.008484, 0.002411, -0.005249, -0.014160, -0.021454, -0.025909, -0.027527, -0.026337, -0.023499, -0.019836, -0.014984, -0.010101, -0.005249, -0.002808, -0.004456, -0.007263, -0.008911, -0.008484, -0.007263, -0.006866, -0.007263, -0.007690, -0.009705, -0.011749, -0.010925, -0.008087, -0.003632, 0.002411, 0.006866, 0.006866, 0.003632, 0.000000, -0.002411, -0.003235, -0.003632, -0.002411, -0.000397, 0.004456, 0.010925, 0.017822, 0.023071, 0.025513, 0.023895, 0.019440, 0.012939, 0.006073, 0.001617, 0.000397, 0.003632, 0.010101, 0.014557, 0.014557, 0.010529, 0.005249, 0.001190, -0.000397, 0.000397, 0.002411, 0.005249, 0.007263, 0.008911, 0.008911, 0.006866, 0.003235, -0.003235, -0.012146, -0.021057, -0.027527, -0.029144, -0.025909, -0.019440, -0.010925, -0.003235, 0.000793, 0.003235, 0.003235, 0.001190, 0.000397, 0.000397, -0.000397, -0.002014, -0.003632, -0.004028, -0.003235, -0.002014, -0.002411, -0.003632, -0.005646, -0.007263, -0.009705, -0.011322, -0.010529, -0.008911, -0.006470, -0.002808, -0.000397, 0.000397, 0.001617, 0.003235, 0.004456, 0.004456, 0.004852, 0.007263, 0.010529, 0.012146, 0.011749, 0.010925, 0.009705, 0.007263, 0.004852, 0.002411, 0.000000, -0.002014, -0.004028, -0.007263, -0.010925, -0.012543, -0.011322, -0.006470, 0.001190, 0.007263, 0.006470, -0.000397, -0.009308, -0.017395, -0.023071, -0.023895, -0.020660, -0.014160, -0.006866, -0.000793, 0.002808, 0.003632, 0.003235, 0.004028, 0.004456, 0.004456, 0.004456, 0.004028, 0.002411, -0.000397, -0.005646, -0.011749, -0.016205, -0.018219, -0.016205, -0.010925, -0.003235, 0.005249, 0.011322, 0.011749, 0.004852, -0.006470, -0.018219, -0.027130, -0.029572, -0.026733, -0.020660, -0.012543, -0.003235, 0.004852, 0.009705, 0.010529, 0.006073, -0.001190, -0.009308, -0.015778, -0.019440, -0.019043, -0.015778, -0.008911, 0.000793, 0.012146, 0.021057, 0.025909, 0.025513, 0.022278, 0.018219, 0.015778, 0.012939, 0.008911, 0.004852, 0.000793, -0.003632, -0.008087, -0.010529, -0.010101, -0.006073, 0.001190, 0.010101, 0.016998, 0.020233, 0.019836, 0.017395, 0.013367, 0.009705, 0.006470, 0.002808, -0.002411, -0.009308, -0.014984, -0.019440, -0.023071, -0.024292, -0.023499, -0.021454, -0.020233, -0.019440, -0.019440, -0.021454, -0.025909, -0.032806, -0.040894, -0.048187, -0.053467, -0.056305, -0.055908, -0.051849, -0.044556, -0.036865, -0.028748, -0.020660, -0.012146, -0.002411, 0.007263, 0.013763, 0.016602, 0.018219, 0.020233, 0.023071, 0.023895, 0.024292, 0.023895, 0.023499, 0.024689, 0.028748, 0.034027, 0.040100, 0.045776, 0.050629, 0.054291, 0.056305, 0.056305, 0.053864, 0.049011, 0.040894, 0.031586, 0.023895, 0.019440, 0.016602, 0.013763, 0.010925, 0.010529, 0.012146, 0.013367, 0.011749, 0.009705, 0.007690, 0.004028, -0.001617, -0.007263, -0.012146, -0.014984, -0.016602, -0.018219, -0.021454, -0.025909, -0.030365, -0.033630, -0.035645, -0.036438, -0.034821, -0.029968, -0.022675, -0.015778, -0.007690, 0.001190, 0.006470, 0.007263, 0.006470, 0.006073, 0.006470, 0.006073, 0.005646, 0.006470, 0.008911, 0.012146, 0.016205, 0.020660, 0.023499, 0.023895, 0.021454, 0.018219, 0.015778, 0.014160, 0.012146, 0.009705, 0.006073, 0.002808, 0.002014, 0.004028, 0.008911, 0.014160, 0.018219, 0.020233, 0.020660, 0.020233, 0.021454, 0.024689, 0.028748, 0.032410, 0.031586, 0.023499, 0.010101, -0.004028, -0.015381, -0.021057, -0.020233, -0.016205, -0.013763, -0.015381, -0.018616, -0.022278, -0.025909, -0.029144, -0.032806, -0.036041, -0.039703, -0.044159, -0.047791, -0.048187, -0.044952, -0.038483, -0.031189, -0.025513, -0.023071, -0.021851, -0.017822, -0.010925, -0.003632, 0.003235, 0.008911, 0.011749, 0.012146, 0.012543, 0.013763, 0.017395, 0.022675, 0.027527, 0.033203, 0.040100, 0.046173, 0.048615, 0.047791, 0.044159, 0.037659, 0.028748, 0.020233, 0.012939, 0.007263, 0.004028, 0.002808, 0.002014, 0.000397, -0.003632, -0.007690, -0.009308, -0.009308, -0.008087, -0.004852, 0.000000, 0.003632, 0.004456, 0.002411, -0.002014, -0.008484, -0.015381, -0.018219, -0.016602, -0.011749, -0.005249, 0.000793, 0.004852, 0.007690, 0.010101, 0.014984, 0.019836, 0.020660, 0.017822, 0.012939, 0.007690, 0.004028, 0.002411, 0.003235, 0.005249, 0.006470, 0.007690, 0.009308, 0.010925, 0.012543, 0.013763, 0.014160, 0.012146, 0.007690, 0.001190, -0.004456, -0.008087, -0.006470, 0.000397, 0.009308, 0.016602, 0.020660, 0.019836, 0.015381, 0.008484, -0.000397, -0.010925, -0.020660, -0.026733, -0.027954, -0.027130, -0.025116, -0.022278, -0.019440, -0.016602, -0.014160, -0.013367, -0.013367, -0.014160, -0.015381, -0.014557, -0.010529, -0.004028, 0.002411, 0.006866, 0.010925, 0.015778, 0.019043, 0.019836, 0.017822, 0.012543, 0.006470, 0.000793, -0.004456, -0.007690, -0.007690, -0.005249, -0.003235, -0.002808, -0.003632, -0.004852, -0.008087, -0.012146, -0.015381, -0.016998, -0.015778, -0.012939, -0.008087, -0.001617, 0.007263, 0.016205, 0.022675, 0.024689, 0.022675, 0.018616, 0.012543, 0.007263, 0.005249, 0.007263, 0.009308, 0.008484, 0.003632, -0.002014, -0.006866, -0.010925, -0.012939, -0.015381, -0.019440, -0.025116, -0.029968, -0.031586, -0.027954, -0.021057, -0.011322, -0.002411, 0.002411, 0.001617, -0.002014, -0.007263, -0.013367, -0.017822, -0.019440, -0.018219, -0.016602, -0.016602, -0.017822, -0.019440, -0.021057, -0.020233, -0.016602, -0.010925, -0.004028, 0.002411, 0.006866, 0.009308, 0.008484, 0.002808, -0.004028, -0.008484, -0.009308, -0.006073, 0.002014, 0.014557, 0.026733, 0.033630, 0.032806, 0.023499, 0.009705, -0.002411, -0.011322, -0.014557, -0.011749, -0.004456, 0.005646, 0.015381, 0.021057, 0.019836, 0.012146, -0.000793, -0.013367, -0.022675, -0.026733, -0.025909, -0.020660, -0.011749, -0.001190, 0.008484, 0.014557, 0.016998, 0.016602, 0.014160, 0.010529, 0.007263, 0.005249, 0.004028, 0.004028, 0.006073, 0.009308, 0.011322, 0.010529, 0.007690, 0.002808, -0.002014, -0.004456, -0.002808, 0.000397, 0.003235, 0.006073, 0.008911, 0.011322, 0.013763, 0.016205, 0.018616, 0.019836, 0.020233, 0.022278, 0.025116, 0.025513, 0.021454, 0.014557, 0.005646, -0.002808, -0.011322, -0.019836, -0.027954, -0.034027, -0.036041, -0.036041, -0.036041, -0.038483, -0.043732, -0.049835, -0.052673, -0.051849, -0.046570, -0.036865, -0.023071, -0.008484, 0.006073, 0.018219, 0.025116, 0.023895, 0.016602, 0.006866, -0.002411, -0.008087, -0.008911, -0.005249, 0.000793, 0.006470, 0.009705, 0.011322, 0.012939, 0.013763, 0.014160, 0.015381, 0.017822, 0.021454, 0.026337, 0.029572, 0.029968, 0.027130, 0.023499, 0.020660, 0.017822, 0.014160, 0.010101, 0.006866, 0.002808, -0.003235, -0.010529, -0.015778, -0.019043, -0.019440, -0.015381, -0.008484, -0.000397, 0.005249, 0.006866, 0.004028, -0.000793, -0.006073, -0.012146, -0.016998, -0.018616, -0.016205, -0.010925, -0.006866, -0.006073, -0.007263, -0.008087, -0.007263, -0.006073, -0.003235, 0.001617, 0.006866, 0.010529, 0.011749, 0.008911, 0.004456, -0.000397, -0.004456, -0.007263, -0.008484, -0.009308, -0.008484, -0.006866, -0.005646, -0.006073, -0.006073, -0.005646, -0.004028, -0.001190, 0.002014, 0.005249, 0.006866, 0.007263, 0.008087, 0.009705, 0.012146, 0.012939, 0.012543, 0.011322, 0.009705, 0.007690, 0.006073, 0.005249, 0.006073, 0.008087, 0.010529, 0.010529, 0.006866, 0.000397, -0.006470, -0.011322, -0.012939, -0.010925, -0.006470, -0.000397, 0.006073, 0.012146, 0.016205, 0.016602, 0.013367, 0.008087, 0.002411, -0.002411, -0.003235, 0.000793, 0.009705, 0.019836, 0.025513, 0.025116, 0.018219, 0.007263, -0.004028, -0.012543, -0.015778, -0.014160, -0.011749, -0.009308, -0.008484, -0.010529, -0.012939, -0.012543, -0.010925, -0.008484, -0.006470, -0.005646, -0.006470, -0.009308, -0.012146, -0.011322, -0.006470, 0.001617, 0.009705, 0.016602, 0.021454, 0.022675, 0.020233, 0.016205, 0.011749, 0.008484, 0.006470, 0.004028, 0.001617, -0.000397, -0.002014, -0.002014, -0.000793, 0.000793, 0.003632, 0.007690, 0.012543, 0.017822, 0.021057, 0.022278, 0.021057, 0.017395, 0.013367, 0.008911, 0.001617, -0.007690, -0.016998, -0.023895, -0.024292, -0.020233, -0.014160, -0.007263, -0.001190, 0.003632, 0.006866, 0.007263, 0.005646, 0.004028, 0.002411, 0.003235, 0.006073, 0.009308, 0.011322, 0.013367, 0.014984, 0.016998, 0.018219, 0.019836, 0.019440, 0.016205, 0.010529, 0.004028, -0.002014, -0.005646, -0.006073, -0.005249, -0.004852, -0.005249, -0.005646, -0.002808, 0.001617, 0.005646, 0.007690, 0.006073, 0.000000, -0.008484, -0.015778, -0.016998, -0.012543, -0.005646, 0.001190, 0.005249, 0.004456, 0.000397, -0.006470, -0.014984, -0.023895, -0.029968, -0.030792, -0.024292, -0.013367, -0.002411, 0.004028, 0.005249, 0.002808, -0.002411, -0.010101, -0.017395, -0.022278, -0.025909, -0.027130, -0.025909, -0.022675, -0.018616, -0.014160, -0.008484, -0.002808, 0.001190, 0.004028, 0.006470, 0.008484, 0.009308, 0.008911, 0.009308, 0.011749, 0.014557, 0.017822, 0.020233, 0.019043, 0.015381, 0.012146, 0.010925, 0.010101, 0.008911, 0.006073, 0.002014, -0.002014, -0.005249, -0.009705, -0.014984, -0.018219, -0.018219, -0.016602, -0.012543, -0.008087, -0.004852, -0.004028, -0.007263, -0.011749, -0.013367, -0.012543, -0.009705, -0.004456, 0.001617, 0.006470, 0.011322, 0.015778, 0.018616, 0.020660, 0.019836, 0.018219, 0.015381, 0.010925, 0.006470, 0.004028, 0.007263, 0.015778, 0.026733, 0.035645, 0.039703, 0.038483, 0.032410, 0.022675, 0.012543, 0.004028, -0.002014, -0.005249, -0.005646, -0.005249, -0.004456, -0.004456, -0.005646, -0.008087, -0.010925, -0.012146, -0.011749, -0.009308, -0.006470, -0.005249, -0.007263, -0.012146, -0.018219, -0.021454, -0.022278, -0.020233, -0.016602, -0.010925, -0.004028, 0.002014, 0.004456, 0.006470, 0.010101, 0.014557, 0.018616, 0.022278, 0.024292, 0.024292, 0.023071, 0.023499, 0.025909, 0.029144, 0.031982, 0.032806, 0.031189, 0.027527, 0.023071, 0.016205, 0.007263, -0.002014, -0.008484, -0.012146, -0.013763, -0.015778, -0.017822, -0.019836, -0.021057, -0.021057, -0.019440, -0.015381, -0.010925, -0.007263, -0.006073, -0.006866, -0.007690, -0.008484, -0.008911, -0.007690, -0.005646, -0.004028, -0.003235, -0.004028, -0.004852, -0.003632, -0.001190, 0.002808, 0.005646, 0.005249, 0.002411, 0.000397, 0.001190, 0.003632, 0.005646, 0.006073, 0.006073, 0.004852, 0.000793, -0.005249, -0.010925, -0.013367, -0.012543, -0.008911, -0.005646, -0.004852, -0.007263, -0.012543, -0.018616, -0.023895, -0.026733, -0.026733, -0.023071, -0.016205, -0.009705, -0.005646, -0.002411, 0.001190, 0.003632, 0.004456, 0.005249, 0.008484, 0.012146, 0.014984, 0.016205, 0.014557, 0.010925, 0.006866, 0.003235, -0.001190, -0.004456, -0.004028, -0.000793, 0.002014, 0.002808, -0.000397, -0.007263, -0.016205, -0.024292, -0.029572, -0.031189, -0.029572, -0.025909, -0.019836, -0.014160, -0.011322, -0.011749, -0.014160, -0.016998, -0.016998, -0.015778, -0.014984, -0.014984, -0.014984, -0.015381, -0.014160, -0.009308, -0.000397, 0.010529, 0.020233, 0.027130, 0.030365, 0.031189, 0.031189, 0.031586, 0.031586, 0.031189, 0.029144, 0.025116, 0.020233, 0.015381, 0.012146, 0.012543, 0.016998, 0.022278, 0.025116, 0.024292, 0.019836, 0.011322, 0.000793, -0.007263, -0.012146, -0.014984, -0.016205, -0.015778, -0.013367, -0.009705, -0.007263, -0.008087, -0.012543, -0.018616, -0.024689, -0.029572, -0.031189, -0.029144, -0.023895, -0.014984, -0.004456, 0.004456, 0.010529, 0.014557, 0.016205, 0.014557, 0.011322, 0.007690, 0.003632, -0.002014, -0.009705, -0.017395, -0.023071, -0.025513, -0.025116, -0.021851, -0.016998, -0.011749, -0.008087, -0.006866, -0.005249, -0.002411, 0.001617, 0.005646, 0.009308, 0.012146, 0.013763, 0.013367, 0.012146, 0.012146, 0.012543, 0.011322, 0.007263, 0.000793, -0.006470, -0.010529, -0.010101, -0.004852, 0.000793, 0.004028, 0.004852, 0.004028, 0.000793, -0.005249, -0.012543, -0.019440, -0.023499, -0.024689, -0.023895, -0.022675, -0.021454, -0.021057, -0.021057, -0.020233, -0.019043, -0.015778, -0.009308, -0.001617, 0.005249, 0.010925, 0.013367, 0.013367, 0.011322, 0.009308, 0.008484, 0.007263, 0.005249, 0.002014, -0.000793, -0.002014, -0.001190, 0.000000, 0.003235, 0.008911, 0.014160, 0.016602, 0.016205, 0.014160, 0.012939, 0.011322, 0.008911, 0.006073, 0.003235, 0.000793, 0.000793, 0.000793, 0.001617, 0.002411, 0.004028, 0.006073, 0.007690, 0.007690, 0.007263, 0.006073, 0.003632, 0.000000, -0.004028, -0.005249, -0.003235, -0.000397, 0.001190, 0.001617, 0.000397, -0.000793, -0.002411, -0.003632, -0.004456, -0.005646, -0.007690, -0.008484, -0.008087, -0.008484, -0.008911, -0.009705, -0.008484, -0.005249, -0.000793, 0.003632, 0.007690, 0.009308, 0.010101, 0.010101, 0.010101, 0.009308, 0.008087, 0.006470, 0.006470, 0.007263, 0.008087, 0.008484, 0.007263, 0.006470, 0.007690, 0.011749, 0.017822, 0.025513, 0.032410, 0.037659, 0.039703, 0.037659, 0.031982, 0.024292, 0.016602, 0.011322, 0.006866, 0.002808, -0.000397, -0.002411, -0.004456, -0.006866, -0.009705, -0.012543, -0.016205, -0.019440, -0.021057, -0.020233, -0.019043, -0.018219, -0.018616, -0.019836, -0.021057, -0.021454, -0.020233, -0.016998, -0.012543, -0.008911, -0.008911, -0.013367, -0.019043, -0.024689, -0.027130, -0.025513, -0.021851, -0.017395, -0.012543, -0.007690, -0.002411, 0.002808, 0.007690, 0.012543, 0.017822, 0.022675, 0.028748, 0.034424, 0.037659, 0.038483, 0.036865, 0.033630, 0.029572, 0.025513, 0.022278, 0.020233, 0.020660, 0.023499, 0.027130, 0.031189, 0.034027, 0.032410, 0.027527, 0.021454, 0.014557, 0.008911, 0.006470, 0.008087, 0.011749, 0.013763, 0.012146, 0.006073, -0.001617, -0.008484, -0.012146, -0.013763, -0.014557, -0.014984, -0.013367, -0.010925, -0.008087, -0.005249, -0.003632, -0.001190, 0.001617, 0.002014, 0.000000, -0.003632, -0.008911, -0.014557, -0.018219, -0.016998, -0.012939, -0.008484, -0.004852, -0.004456, -0.007263, -0.012146, -0.017395, -0.022278, -0.025116, -0.025116, -0.021851, -0.016602, -0.010925, -0.006470, -0.004456, -0.004028, -0.003235, -0.002411, -0.002014, -0.001617, -0.001190, -0.000793, 0.001617, 0.005249, 0.010925, 0.016602, 0.021454, 0.024689, 0.025116, 0.023071, 0.018219, 0.012146, 0.006470, 0.002411, 0.000397, 0.000000, 0.001617, 0.004456, 0.007263, 0.006866, 0.002808, -0.002808, -0.008484, -0.013763, -0.017822, -0.019836, -0.019836, -0.019440, -0.017822, -0.014557, -0.011322, -0.009705, -0.009308, -0.008911, -0.007690, -0.005249, -0.004456, -0.004852, -0.006470, -0.008484, -0.010101, -0.010925, -0.011749, -0.011322, -0.010529, -0.008087, -0.004852, -0.000793, 0.001190, 0.000000, -0.004852, -0.010101, -0.012543, -0.011749, -0.011322, -0.010925, -0.008484, -0.004028, 0.000397, 0.003632, 0.004852, 0.004456, 0.002808, 0.001190, 0.001190, 0.002411, 0.004852, 0.006866, 0.007690, 0.008087, 0.007690, 0.006470, 0.005249, 0.004028, 0.002808, 0.001617, 0.000793, -0.000397, -0.000397, 0.000793, 0.002014, 0.002014, 0.000793, -0.001617, -0.004852, -0.008087, -0.010925, -0.013367, -0.013763, -0.011749, -0.008087, -0.003235, 0.001190, 0.003632, 0.002411, -0.002411, -0.009705, -0.016602, -0.020660, -0.019440, -0.014160, -0.006470, 0.000793, 0.005646, 0.007690, 0.009705, 0.011749, 0.012146, 0.012146, 0.012543, 0.013367, 0.015778, 0.019440, 0.023071, 0.025909, 0.027527, 0.027527, 0.025116, 0.020233, 0.012146, 0.002808, -0.006470, -0.013763, -0.017822, -0.018616, -0.015778, -0.011322, -0.008484, -0.007690, -0.009308, -0.012543, -0.015381, -0.015778, -0.013367, -0.007263, 0.000397, 0.006866, 0.010101, 0.010529, 0.009705, 0.009308, 0.010101, 0.011749, 0.012543, 0.012939, 0.012543, 0.010529, 0.007263, 0.004028, 0.003235, 0.005249, 0.008911, 0.011322, 0.011322, 0.008087, 0.002808, -0.003235, -0.008484, -0.011749, -0.012146, -0.012543, -0.014557, -0.019043, -0.023499, -0.024292, -0.020660, -0.012939, -0.003632, 0.003632, 0.007263, 0.007263, 0.003632, -0.002014, -0.008087, -0.013367, -0.016998, -0.019440, -0.019440, -0.015381, -0.009705, -0.003632, 0.002411, 0.007263, 0.013367, 0.019043, 0.023895, 0.026733, 0.027527, 0.025513, 0.023071, 0.019043, 0.014557, 0.010529, 0.007263, 0.005249, 0.005249, 0.007263, 0.010529, 0.013367, 0.014984, 0.015778, 0.015381, 0.013367, 0.010529, 0.006866, 0.002411, -0.002014, -0.005646, -0.006866, -0.004852, -0.000793, 0.003632, 0.008484, 0.010925, 0.010529, 0.006866, 0.002014, -0.002014, -0.004456, -0.005249, -0.004852, -0.005646, -0.007263, -0.009308, -0.010925, -0.011322, -0.009705, -0.007690, -0.005646, -0.004852, -0.004852, -0.004456, -0.003632, -0.002014, 0.000000, 0.001190, 0.002411, 0.002014, 0.000793, -0.001190, -0.003632, -0.005646, -0.005646, -0.003632, 0.001190, 0.008087, 0.014984, 0.019440, 0.021454, 0.021057, 0.018219, 0.012543, 0.004852, -0.003235, -0.009308, -0.011322, -0.009705, -0.004456, 0.002808, 0.010529, 0.016998, 0.020660, 0.021057, 0.016998, 0.010529, 0.003235, -0.003632, -0.008911, -0.011749, -0.011749, -0.009308, -0.006470, -0.004852, -0.005249, -0.008087, -0.011749, -0.014984, -0.016998, -0.017822, -0.017822, -0.016602, -0.014557, -0.012146, -0.010529, -0.009308, -0.008911, -0.009308, -0.010925, -0.012146, -0.012939, -0.013367, -0.012543, -0.011749, -0.010529, -0.008911, -0.006470, -0.003632, -0.000793, 0.002411, 0.005249, 0.006470, 0.006073, 0.004456, 0.001190, -0.002808, -0.007263, -0.010101, -0.009705, -0.006470, 0.000397, 0.009308, 0.015778, 0.018219, 0.017395, 0.014160, 0.010529, 0.007690, 0.006073, 0.004456, 0.002014, -0.001190, -0.005249, -0.010101, -0.015381, -0.019440, -0.021454, -0.022278, -0.021851, -0.021057, -0.019440, -0.016998, -0.014557, -0.011322, -0.008911, -0.007263, -0.006073, -0.005646, -0.004852, -0.002411, 0.001617, 0.006470, 0.010101, 0.012543, 0.013763, 0.012146, 0.009308, 0.005646, 0.002411, 0.001190, 0.003235, 0.008087, 0.013763, 0.018616, 0.021057, 0.019440, 0.014557, 0.008911, 0.004852, 0.003235, 0.003632, 0.004852, 0.005646, 0.004852, 0.004456, 0.005249, 0.006470, 0.007263, 0.006470, 0.004028, 0.001190, -0.002014, -0.004852, -0.006470, -0.007690, -0.008484, -0.007263, -0.004456, -0.002411, -0.001617, -0.002014, -0.002411, -0.003235, -0.005249, -0.007690, -0.010101, -0.012543, -0.013763, -0.013367, -0.012146, -0.010529, -0.009308, -0.007263, -0.004456, -0.000793, 0.002014, 0.002014, 0.000793, 0.000397, 0.001617, 0.003235, 0.004028, 0.003632, 0.002808, 0.002808, 0.002411, 0.002014, 0.002411, 0.003632, 0.006073, 0.009308, 0.012543, 0.015778, 0.017822, 0.019043, 0.018219, 0.015381, 0.012146, 0.010101, 0.010101, 0.012146, 0.014160, 0.015778, 0.016602, 0.015381, 0.012543, 0.008484, 0.004852, 0.002411, 0.001190, 0.000000, -0.000793, -0.002411, -0.004852, -0.006866, -0.008484, -0.010529, -0.013367, -0.016205, -0.017395, -0.016998, -0.014557, -0.011322, -0.007263, -0.004852, -0.004456, -0.006073, -0.008484, -0.010101, -0.009705, -0.008484, -0.006470, -0.004028, -0.002808, -0.004028, -0.006073, -0.007690, -0.006073, -0.002808, 0.000397, 0.002808, 0.003235, 0.002411, 0.000793, -0.000397, -0.000793, 0.000000, 0.001617, 0.003235, 0.003632, 0.003235, 0.003632, 0.006073, 0.009308, 0.012146, 0.013367, 0.012543, 0.008911, 0.004028, -0.001617, -0.006470, -0.008484, -0.008484, -0.007263, -0.005249, -0.003632, -0.004028, -0.005646, -0.006866, -0.006470, -0.003235, 0.001617, 0.006866, 0.010925, 0.012939, 0.013367, 0.011322, 0.007263, 0.001617, -0.003632, -0.008484, -0.011749, -0.012939, -0.013367, -0.012939, -0.012146, -0.011322, -0.010925, -0.009705, -0.007690, -0.005249, -0.002411, -0.000397, 0.000397, -0.000793, -0.001617, -0.002014, -0.000793, 0.002411, 0.006866, 0.012146, 0.017395, 0.021057, 0.023071, 0.023895, 0.023499, 0.020660, 0.016602, 0.012543, 0.008911, 0.006073, 0.003632, 0.002014, 0.002014, 0.002808, 0.003235, 0.003235, 0.003235, 0.002411, 0.000397, -0.000793, -0.002014, -0.002808, -0.002808, -0.002014, -0.000397, 0.001617, 0.004028, 0.005646, 0.006073, 0.004456, 0.001190, -0.002808, -0.006470, -0.008484, -0.007690, -0.005646, -0.003235, -0.001617, -0.000793, -0.000793, -0.001617, -0.003235, -0.004852, -0.006470, -0.006866, -0.007263, -0.007263, -0.006866, -0.006470, -0.006073, -0.006073, -0.004028, -0.000793, 0.001190, 0.001617, 0.000793, -0.000793, -0.002411, -0.003235, -0.003632, -0.003235, -0.000793, 0.001617, 0.003235, 0.004456, 0.004456, 0.004028, 0.003632, 0.001617, -0.001617, -0.004456, -0.006073, -0.006073, -0.004852, -0.003632, -0.002411, -0.002014, -0.002411, -0.003632, -0.005646, -0.007263, -0.006866, -0.003632, 0.001617, 0.007690, 0.011749, 0.014160, 0.015381, 0.016602, 0.018616, 0.021057, 0.022278, 0.021851, 0.019043, 0.013763, 0.008087, 0.004028, 0.001190, -0.001617, -0.004852, -0.008087, -0.010101, -0.011322, -0.011322, -0.010101, -0.008911, -0.007690, -0.006866, -0.007263, -0.008911, -0.010529, -0.012146, -0.014160, -0.018219, -0.023499, -0.028748, -0.032410, -0.033630, -0.031189, -0.026733, -0.020660, -0.014160, -0.008087, -0.003235, -0.000793, -0.000793, -0.002014, -0.003632, -0.004028, -0.001190, 0.004456, 0.011322, 0.017395, 0.021057, 0.022675, 0.023499, 0.024292, 0.024689, 0.024689, 0.024292, 0.022675, 0.019440, 0.015778, 0.011322, 0.006470, 0.002411, 0.000000, -0.002014, -0.004456, -0.007690, -0.012146, -0.017822, -0.024689, -0.030792, -0.034821, -0.035645, -0.032806, -0.027130, -0.019440, -0.012939, -0.006866, -0.001617, 0.002411, 0.004852, 0.005646, 0.004852, 0.003235, 0.001190, 0.000397, 0.000397, 0.001190, 0.002808, 0.004028, 0.004456, 0.003235, 0.002411, 0.002411, 0.004028, 0.007263, 0.009308, 0.009705, 0.008087, 0.007690, 0.009705, 0.012543, 0.015778, 0.017822, 0.018219, 0.017395, 0.016205, 0.014557, 0.013367, 0.012543, 0.012939, 0.014160, 0.015778, 0.016205, 0.015381, 0.012939, 0.009705, 0.006470, 0.003632, 0.002014, 0.000397, -0.000793, -0.001617, -0.002808, -0.005249, -0.006866, -0.008087, -0.008911, -0.009308, -0.008484, -0.006470, -0.004852, -0.004456, -0.006073, -0.009308, -0.014557, -0.019043, -0.021851, -0.021057, -0.016998, -0.012146, -0.006470, -0.001617, 0.001190, 0.002808, 0.004028, 0.004456, 0.005249, 0.006073, 0.007263, 0.009705, 0.013367, 0.017395, 0.021851, 0.025513, 0.027954, 0.028351, 0.026337, 0.021454, 0.014557, 0.008484, 0.004456, 0.001190, -0.001190, -0.002411, -0.002411, -0.002411, -0.003235, -0.004852, -0.005646, -0.005249, -0.004456, -0.003632, -0.002411, -0.001190, -0.000397, 0.000793, 0.001190, 0.000793, 0.000000, 0.000000, 0.001190, 0.002014, 0.001190, -0.001617, -0.006866, -0.012543, -0.016998, -0.018219, -0.016998, -0.014984, -0.012939, -0.012146, -0.012543, -0.012543, -0.011749, -0.010101, -0.008484, -0.007263, -0.006470, -0.005646, -0.004852, -0.004028, -0.002014, 0.000793, 0.002411, 0.002014, 0.000397, -0.000397, 0.000793, 0.003632, 0.006470, 0.008484, 0.008911, 0.008911, 0.008484, 0.008911, 0.010101, 0.010529, 0.010529, 0.009308, 0.007690, 0.006866, 0.006470, 0.006470, 0.006073, 0.005249, 0.002014, -0.002808, -0.006866, -0.008911, -0.009308, -0.008484, -0.006073, -0.002808, 0.000397, 0.003235, 0.003632, 0.000793, -0.004852, -0.010101, -0.012543, -0.011322, -0.006866, -0.001617, 0.002808, 0.005646, 0.006470, 0.006073, 0.004852, 0.003632, 0.002411, 0.002411, 0.004028, 0.005646, 0.007690, 0.010101, 0.012939, 0.014160, 0.012939, 0.009705, 0.004852, 0.001190, -0.001617, -0.003632, -0.004852, -0.005249, -0.005646, -0.005646, -0.005646, -0.005646, -0.006866, -0.008484, -0.010529, -0.011749, -0.012146, -0.010101, -0.005646, -0.000793, 0.003632, 0.005646, 0.004456, 0.002411, 0.000000, -0.001190, -0.001190, -0.000793, 0.000793, 0.002808, 0.005646, 0.008087, 0.010101, 0.010925, 0.009705, 0.008087, 0.006073, 0.004028, 0.000793, -0.002808, -0.005646, -0.006866, -0.006073, -0.003235, 0.000793, 0.004852, 0.008484, 0.010529, 0.010925, 0.010101, 0.008087, 0.004456, -0.000397, -0.005646, -0.009705, -0.011322, -0.010925, -0.010101, -0.008484, -0.006866, -0.005249, -0.003235, -0.001617, -0.002014, -0.003235, -0.004456, -0.005646, -0.007263, -0.010101, -0.011749, -0.011749, -0.010101, -0.007263, -0.004028, -0.001617, 0.000000, 0.000397, 0.000397, 0.001190, 0.004028, 0.008087, 0.011749, 0.013367, 0.012543, 0.010925, 0.008911, 0.006866, 0.006470, 0.006866, 0.007263, 0.007263, 0.007263, 0.007263, 0.006470, 0.003632, 0.000397, -0.002808, -0.004852, -0.004852, -0.003632, -0.002411, -0.002014, -0.002411, -0.003235, -0.004456, -0.004852, -0.004456, -0.004028, -0.003632, -0.003632, -0.003632, -0.002808, -0.001617, 0.000397, 0.002014, 0.002808, 0.001617, 0.000000, -0.002808, -0.005646, -0.008484, -0.011322, -0.012939, -0.012146, -0.009308, -0.006470, -0.004028, -0.004028, -0.005249, -0.007690, -0.009308, -0.008484, -0.006073, -0.002808, 0.001617, 0.006470, 0.010101, 0.012146, 0.012146, 0.010925, 0.008911, 0.007263, 0.006073, 0.005249, 0.004456, 0.005249, 0.007690, 0.009705, 0.010101, 0.008911, 0.006866, 0.004456, 0.003235, 0.003632, 0.003235, 0.002014, 0.000397, -0.002014, -0.004852, -0.006470, -0.007690, -0.008087, -0.007690, -0.005646, -0.002411, 0.000397, 0.001190, 0.000000, -0.002411, -0.004028, -0.004028, -0.001617, 0.002411, 0.005646, 0.007263, 0.007263, 0.006073, 0.004456, 0.002411, 0.000397, -0.000793, -0.000793, 0.000000, 0.000793, 0.000793, 0.000000, -0.001617, -0.004028, -0.007263, -0.010529, -0.012543, -0.012939, -0.012543, -0.012146, -0.012146, -0.012543, -0.012543, -0.012146, -0.010925, -0.008911, -0.006470, -0.003632, -0.000793, 0.002014, 0.004456, 0.006470, 0.007263, 0.007690, 0.007263, 0.006470, 0.006073, 0.006470, 0.007690, 0.009308, 0.011322, 0.014160, 0.017395, 0.019440, 0.019836, 0.019440, 0.017822, 0.014160, 0.008911, 0.001617, -0.005249, -0.010101, -0.012146, -0.010925, -0.007263, -0.001617, 0.004456, 0.009308, 0.011749, 0.011322, 0.007690, 0.002411, -0.003235, -0.008087, -0.010101, -0.009705, -0.008087, -0.006073, -0.003632, -0.002014, -0.000397, 0.000000, 0.000397, 0.000000, -0.000793, -0.002014, -0.004028, -0.005646, -0.006866, -0.007263, -0.006866, -0.006073, -0.004852, -0.002808, -0.000397, 0.001190, 0.002808, 0.003632, 0.004456, 0.005646, 0.007690, 0.008911, 0.008911, 0.006470, 0.002014, -0.002808, -0.006470, -0.007263, -0.005249, -0.002014, 0.001190, 0.005249, 0.008484, 0.010925, 0.011749, 0.012146, 0.012146, 0.011749, 0.009705, 0.006866, 0.003632, 0.002014, 0.002014, 0.001617, 0.000000, -0.003235, -0.006470, -0.009308, -0.010925, -0.011749, -0.011322, -0.009705, -0.008087, -0.006073, -0.004456, -0.003235, -0.002014, -0.001617, -0.002014, -0.002014, -0.002411, -0.002808, -0.002411, -0.001617, -0.000793, 0.000000, 0.000397, 0.000397, 0.000793, 0.000793, 0.000793, 0.000000, -0.001190, -0.002014, -0.002014, -0.000793, 0.001190, 0.002411, 0.002014, 0.000793, -0.000397, -0.002014, -0.002808, -0.002808, -0.002014, -0.001190, -0.000397, 0.000397, 0.000793, 0.000397, -0.001190, -0.003235, -0.004456, -0.004028, -0.003632, -0.002411, -0.001190, 0.000793, 0.002808, 0.004852, 0.006866, 0.008911, 0.010101, 0.010529, 0.010101, 0.008911, 0.007263, 0.004028, 0.001190, -0.000793, -0.003235, -0.005249, -0.006866, -0.006866, -0.006073, -0.004028, -0.002411, -0.000793, 0.000000, 0.001190, 0.002411, 0.003235, 0.003632, 0.003235, 0.002411, 0.002411, 0.003235, 0.004852, 0.007690, 0.010925, 0.014984, 0.019440, 0.022278, 0.022675, 0.021851, 0.019440, 0.016602, 0.013367, 0.009705, 0.005646, 0.002411, 0.000397, 0.000000, 0.000397, 0.000397, -0.000793, -0.002411, -0.004456, -0.006073, -0.007263, -0.008087, -0.008087, -0.007690, -0.007263, -0.007263, -0.008087, -0.008911, -0.010101, -0.010529, -0.010925, -0.011322, -0.011322, -0.010925, -0.010529, -0.009705, -0.008484, -0.006866, -0.004456, -0.001617, 0.001190, 0.003632, 0.005249, 0.006073, 0.006866, 0.007263, 0.006866, 0.005646, 0.004456, 0.004028, 0.005249, 0.006866, 0.008087, 0.008087, 0.006470, 0.003235, 0.000397, -0.001617, -0.002014, -0.002014, -0.002014, -0.002014, -0.002808, -0.003632, -0.003632, -0.003235, -0.002411, -0.001617, -0.001617, -0.002411, -0.003235, -0.004028, -0.004852, -0.005646, -0.006073, -0.006073, -0.006470, -0.006073, -0.004852, -0.003632, -0.002808, -0.002014, -0.002808, -0.004456, -0.006470, -0.008911, -0.011322, -0.012939, -0.013367, -0.012146, -0.009705, -0.006866, -0.004028, -0.001190, 0.002411, 0.007263, 0.011322, 0.013367, 0.012146, 0.007690, 0.002411, -0.002808, -0.006073, -0.006470, -0.004456, -0.002411, -0.000793, -0.000397, -0.001190, -0.002411, -0.003235, -0.004028, -0.004456, -0.004456, -0.004028, -0.003235, -0.002411, -0.001190, 0.000793, 0.002411, 0.003235, 0.003235, 0.002411, 0.001617, -0.000793, -0.003235, -0.006470, -0.008911, -0.009705, -0.009308, -0.006866, -0.002411, 0.002411, 0.006073, 0.008087, 0.008087, 0.005249, 0.000397, -0.004028, -0.006866, -0.006470, -0.004456, -0.001617, 0.001617, 0.004456, 0.006073, 0.005646, 0.004028, 0.002014, 0.001190, 0.000793, 0.000000, -0.000397, -0.000793, 0.000000, 0.000793, 0.000793, 0.000793, 0.000793, 0.001617, 0.002808, 0.005646, 0.008087, 0.010101, 0.010101, 0.008087, 0.004456, 0.000793, -0.002411, -0.004456, -0.004852, -0.004028, -0.002014, -0.000397, 0.000793, 0.000793, 0.000793, -0.000397, -0.002411, -0.003632, -0.004028, -0.003235, -0.002014, -0.000793, 0.001190, 0.002808, 0.003632, 0.003632, 0.003235, 0.002014, 0.000000, -0.001190, -0.002014, -0.002808, -0.003235, -0.004028, -0.004456, -0.004456, -0.003235, -0.002014, -0.002014, -0.004028, -0.006470, -0.008911, -0.009308, -0.007690, -0.004852, -0.001617, 0.001190, 0.002808, 0.004028, 0.004852, 0.006470, 0.007690, 0.008087, 0.007690, 0.006470, 0.004456, 0.002014, -0.000397, -0.002808, -0.004456, -0.005249, -0.004456, -0.002808, -0.001617, -0.000397, 0.000793, 0.000793, 0.000397, -0.000397, -0.001190, -0.002411, -0.002808, -0.003235, -0.004456, -0.006866, -0.009705, -0.012543, -0.014557, -0.015778, -0.015381, -0.012939, -0.009308, -0.005249, -0.001190, 0.002411, 0.005249, 0.006866, 0.008911, 0.011322, 0.013367, 0.014984, 0.015381, 0.014984, 0.013763, 0.012146, 0.010529, 0.009705, 0.009308, 0.009705, 0.009308, 0.008484, 0.006866, 0.004456, 0.002411, 0.001190, 0.000397, -0.000397, -0.000793, -0.001617, -0.002411, -0.002411, -0.001190, 0.000793, 0.002411, 0.003632, 0.003632, 0.003235, 0.002411, 0.001617, 0.000397, -0.000793, -0.001617, -0.001617, -0.001617, -0.002014, -0.002411, -0.003235, -0.004028, -0.004852, -0.005249, -0.006073, -0.006866, -0.008484, -0.011322, -0.014160, -0.016205, -0.015778, -0.012939, -0.009308, -0.006073, -0.004028, -0.002411, -0.000793, 0.000397, 0.000000, -0.001617, -0.003235, -0.003235, -0.001190, 0.002014, 0.005249, 0.007263, 0.008484, 0.008484, 0.007263, 0.005249, 0.002411, -0.000397, -0.001617, -0.002014, -0.001617, -0.000397, 0.000793, 0.001617, 0.002411, 0.004456, 0.007690, 0.011322, 0.013763, 0.014557, 0.012939, 0.010529, 0.007263, 0.004028, 0.001617, 0.000000, -0.000397, -0.000793, -0.000793, -0.000793, -0.001617, -0.002014, -0.002808, -0.003235, -0.003235, -0.002808, -0.001190, 0.000397, 0.002411, 0.004456, 0.006073, 0.006470, 0.004852, 0.001617, -0.001617, -0.005249, -0.008484, -0.010529, -0.010101, -0.007690, -0.003632, 0.001190, 0.004852, 0.006866, 0.007263, 0.006866, 0.006866, 0.006470, 0.005646, 0.003632, 0.001190, -0.001190, -0.004028, -0.005646, -0.005646, -0.004852, -0.002411, 0.000000, 0.002808, 0.004028, 0.004456, 0.004028, 0.002411, 0.000000, -0.002808, -0.004852, -0.005249, -0.004456, -0.003235, -0.001617, 0.000000, 0.001190, 0.001190, 0.000000, -0.003235, -0.006866, -0.010101, -0.012543, -0.013367, -0.012146, -0.009308, -0.005249, -0.000793, 0.002808, 0.004852, 0.006470, 0.008484, 0.010529, 0.010925, 0.008911, 0.005249, 0.000793, -0.002411, -0.004028, -0.005249, -0.005249, -0.005249, -0.004852, -0.003235, -0.000397, 0.002808, 0.006073, 0.008484, 0.010101, 0.010925, 0.011749, 0.012146, 0.011322, 0.009308, 0.007690, 0.006470, 0.005646, 0.004852, 0.003632, 0.002014, 0.000000, -0.002411, -0.004852, -0.006866, -0.008484, -0.008484, -0.007690, -0.006470, -0.006073, -0.006866, -0.008484, -0.010529, -0.013367, -0.016602, -0.018219, -0.018616, -0.016998, -0.013763, -0.008911, -0.003632, 0.000397, 0.003235, 0.005646, 0.006470, 0.006866, 0.008087, 0.009705, 0.011322, 0.013763, 0.015778, 0.017395, 0.018616, 0.018219, 0.016205, 0.013763, 0.010925, 0.007690, 0.004456, 0.002014, 0.000000, -0.000397, 0.000000, 0.000397, 0.000793, 0.001190, 0.002014, 0.003632, 0.004028, 0.003235, 0.001190, -0.000793, -0.003235, -0.004852, -0.006470, -0.007690, -0.008911, -0.010529, -0.010925, -0.011322, -0.011322, -0.010529, -0.010101, -0.010925, -0.012146, -0.013367, -0.014160, -0.014160, -0.013367, -0.011749, -0.010101, -0.008484, -0.007263, -0.006073, -0.005249, -0.004456, -0.002808, -0.000397, 0.002808, 0.005646, 0.008484, 0.010529, 0.011749, 0.011749, 0.010529, 0.008484, 0.006470, 0.005646, 0.005646, 0.006073, 0.007263, 0.008911, 0.011749, 0.014557, 0.016602, 0.017822, 0.017822, 0.016602, 0.014557, 0.012543, 0.011322, 0.010101, 0.008484, 0.005646, 0.002411, -0.000793, -0.003235, -0.005646, -0.007690, -0.008484, -0.008087, -0.007263, -0.006470, -0.006470, -0.006866, -0.007263, -0.006470, -0.005646, -0.004456, -0.003235, -0.002411, -0.001617, -0.001190, -0.000397, 0.000000, 0.000000, 0.000000, 0.000397, 0.000397, 0.000793, 0.000793, 0.001190, 0.001190, 0.001190, 0.000000, -0.002014, -0.004028, -0.006073, -0.007263, -0.007263, -0.006866, -0.005249, -0.003235, -0.002411, -0.002808, -0.003632, -0.004456, -0.004456, -0.003632, -0.003235, -0.002014, -0.000793, 0.000397, 0.001190, 0.001190, 0.001617, 0.001190, 0.000397, -0.000793, -0.002411, -0.003632, -0.005249, -0.006470, -0.006866, -0.005646, -0.003235, 0.000000, 0.002411, 0.004456, 0.005249, 0.004852, 0.003235, 0.000793, -0.002014, -0.004456, -0.005646, -0.006073, -0.005646, -0.004028, -0.002014, 0.000397, 0.002014, 0.003632, 0.004028, 0.003235, 0.002411, 0.002411, 0.003235, 0.004456, 0.005646, 0.006866, 0.006866, 0.006866, 0.006470, 0.006866, 0.007690, 0.008484, 0.009308, 0.009308, 0.008484, 0.006866, 0.005249, 0.004456, 0.003632, 0.002808, 0.000793, -0.002014, -0.004852, -0.008484, -0.012146, -0.014557, -0.015381, -0.014557, -0.012543, -0.009308, -0.005646, -0.002808, -0.000397, 0.000397, 0.000397, 0.000000, -0.000397, 0.000000, 0.000397, 0.000793, 0.001190, 0.001190, 0.001190, 0.001190, 0.002014, 0.002411, 0.003235, 0.004028, 0.004852, 0.004456, 0.003235, 0.001190, -0.000397, -0.001190, 0.000000, 0.002411, 0.005249, 0.007263, 0.008484, 0.009308, 0.009308, 0.008484, 0.007263, 0.006073, 0.004456, 0.002808, 0.000793, -0.001190, -0.002808, -0.003632, -0.002808, 0.000000, 0.003632, 0.004852, 0.002808, -0.002411, -0.008911, -0.014557, -0.018219, -0.019043, -0.018219, -0.016205, -0.014160, -0.012543, -0.011322, -0.010101, -0.010101, -0.010529, -0.011322, -0.011749, -0.012543, -0.012543, -0.012146, -0.010529, -0.007690, -0.005646, -0.004456, -0.004028, -0.003632, -0.002411, 0.000000, 0.002808, 0.006073, 0.008484, 0.009705, 0.009705, 0.008911, 0.007690, 0.006866, 0.006866, 0.006866, 0.007690, 0.008484, 0.009308, 0.009705, 0.009308, 0.009308, 0.008484, 0.008087, 0.007690, 0.007263, 0.007263, 0.007263, 0.007263, 0.006470, 0.005249, 0.004456, 0.003632, 0.002014, -0.000793, -0.004456, -0.007690, -0.008911, -0.008087, -0.006470, -0.004852, -0.003632, -0.003632, -0.003632, -0.004028, -0.004028, -0.003632, -0.002411, -0.001190, -0.000397, -0.000793, -0.001190, -0.001617, -0.001617, -0.000397, 0.000397, 0.001617, 0.003235, 0.004852, 0.006470, 0.007263, 0.006866, 0.005646, 0.003632, 0.001617, 0.000000, -0.000397, -0.000397, 0.001190, 0.002014, 0.002014, 0.000397, -0.001190, -0.001190, -0.000397, 0.001190, 0.002411, 0.002808, 0.001617, -0.000397, -0.003235, -0.005249, -0.006073, -0.005646, -0.004456, -0.003632, -0.003235, -0.002808, -0.002014, 0.000000, 0.001190, 0.001617, 0.000793, -0.000397, -0.001617, -0.002808, -0.002808, -0.001617, 0.001190, 0.004028, 0.006470, 0.007690, 0.008087, 0.008087, 0.007263, 0.005646, 0.004028, 0.002808, 0.002808, 0.002808, 0.002808, 0.002411, 0.001190, -0.000397, -0.001617, -0.002014, -0.001617, -0.000793, 0.000000, 0.000793, 0.002014, 0.002411, 0.001617, 0.000397, -0.001190, -0.002411, -0.003632, -0.004028, -0.004456, -0.004852, -0.004456, -0.004028, -0.002808, -0.001617, -0.000793, -0.000793, -0.002014, -0.004456, -0.006866, -0.008911, -0.008911, -0.007690, -0.004852, -0.002014, 0.000397, 0.001190, 0.001190, 0.001190, 0.001617, 0.001617, 0.001190, 0.000397, -0.001190, -0.002014, -0.002411, -0.001617, -0.000793, 0.000000, 0.000793, 0.001190, 0.002014, 0.003235, 0.004852, 0.005249, 0.004852, 0.004852, 0.004028, 0.003235, 0.002808, 0.002808, 0.003632, 0.005646, 0.008484, 0.011322, 0.013367, 0.014557, 0.014160, 0.012939, 0.010925, 0.008087, 0.004852, 0.001617, -0.000793, -0.001617, -0.001617, -0.000793, -0.000397, -0.000793, -0.001190, -0.001617, -0.002014, -0.002014, -0.003235, -0.005646, -0.008087, -0.010101, -0.011322, -0.011749, -0.011322, -0.010925, -0.010101, -0.008484, -0.006073, -0.004028, -0.002014, -0.000397, 0.000793, 0.002014, 0.003235, 0.004028, 0.003632, 0.002411, 0.001190, 0.000397, -0.000793, -0.001617, -0.002411, -0.002808, -0.002411, -0.000397, 0.001617, 0.003235, 0.004028, 0.004028, 0.003632, 0.003632, 0.003632, 0.003632, 0.004028, 0.003632, 0.003632, 0.003235, 0.002411, 0.001190, 0.000397, 0.000000, 0.000000, 0.000793, 0.002014, 0.003235, 0.003632, 0.002808, 0.000397, -0.002411, -0.004456, -0.005249, -0.004852, -0.004456, -0.003235, -0.002014, -0.000793, -0.000397, -0.000397, -0.001190, -0.002411, -0.003235, -0.003235, -0.002411, -0.000793, 0.001190, 0.003235, 0.004852, 0.006866, 0.008484, 0.009308, 0.008484, 0.006470, 0.004456, 0.002808, 0.002411, 0.002411, 0.002411, 0.002411, 0.001190, -0.000397, -0.002808, -0.005646, -0.007690, -0.009308, -0.010529, -0.011322, -0.012146, -0.011749, -0.010529, -0.008484, -0.006866, -0.006073, -0.006470, -0.006866, -0.007263, -0.006073, -0.003632, -0.000397, 0.002808, 0.004852, 0.006073, 0.005646, 0.004456, 0.002808, 0.001617, 0.001190, 0.002014, 0.003235, 0.004852, 0.006073, 0.006470, 0.006073, 0.005249, 0.004028, 0.002014, 0.000000, -0.001617, -0.002411, -0.002014, -0.000397, 0.001617, 0.003235, 0.004852, 0.006470, 0.007690, 0.008087, 0.008484, 0.008484, 0.008087, 0.006470, 0.004028, 0.000397, -0.004028, -0.008087, -0.010529, -0.010529, -0.008484, -0.006073, -0.004028, -0.002014, -0.000397, 0.000397, 0.000793, 0.001190, 0.001190, 0.000793, -0.000397, -0.001190, -0.000793, 0.000000, 0.000793, 0.001190, 0.000397, 0.000397, 0.000397, 0.000793, 0.001190, 0.001190, 0.001190, 0.000793, 0.000397, 0.000397, 0.001190, 0.001617, 0.002014, 0.002014, 0.001190, -0.000397, -0.002014, -0.003235, -0.003632, -0.003235, -0.002808, -0.002411, -0.002411, -0.003235, -0.003632, -0.004028, -0.004028, -0.002808, -0.000793, 0.001617, 0.004028, 0.006470, 0.007690, 0.008087, 0.006470, 0.004028, 0.000793, -0.001617, -0.004028, -0.005646, -0.007263, -0.008911, -0.010529, -0.011322, -0.011749, -0.012146, -0.010925, -0.008911, -0.005646, -0.003235, -0.001617, 0.000000, 0.001190, 0.002808, 0.003632, 0.003235, 0.002411, 0.000793, 0.000000, 0.000000, 0.000397, 0.001617, 0.002411, 0.002411, 0.001190, 0.000000, -0.000793, -0.001190, -0.000397, 0.000397, 0.002411, 0.004456, 0.006073, 0.006866, 0.007263, 0.006866, 0.006866, 0.006866, 0.007263, 0.007690, 0.008087, 0.007690, 0.006470, 0.004852, 0.002411, 0.000000, -0.001617, -0.002808, -0.002808, -0.002014, -0.000397, 0.001190, 0.002808, 0.003235, 0.002808, 0.001190, -0.000397, -0.001190, -0.001617, -0.002014, -0.003632, -0.005646, -0.007263, -0.008484, -0.008911, -0.009308, -0.009308, -0.008484, -0.007690, -0.007263, -0.006866, -0.006470, -0.006470, -0.007263, -0.008484, -0.008484, -0.007263, -0.004028, 0.000000, 0.003235, 0.005249, 0.006073, 0.005249, 0.004028, 0.002411, 0.001190, 0.000793, 0.001190, 0.002808, 0.004456, 0.005646, 0.006470, 0.006073, 0.005249, 0.003632, 0.002411, 0.002014, 0.002014, 0.002411, 0.002411, 0.002808, 0.003235, 0.003235, 0.002411, 0.001617, 0.000000, -0.001190, -0.002014, -0.001617, -0.001617, -0.001617, -0.002411, -0.003235, -0.004456, -0.006073, -0.007263, -0.008087, -0.008484, -0.008484, -0.007690, -0.006073, -0.004456, -0.002808, -0.000793, 0.001190, 0.003235, 0.004852, 0.006073, 0.005646, 0.003235, 0.000000, -0.003632, -0.005646, -0.005249, -0.002808, 0.000397, 0.003235, 0.005646, 0.006470, 0.006073, 0.005249, 0.004028, 0.002411, 0.000793, -0.000397, -0.001190, -0.001190, -0.000397, 0.000793, 0.002014, 0.002411, 0.002014, 0.001190, 0.000000, -0.000793, -0.001190, -0.000793, -0.000397, 0.000397, 0.000793, 0.001190, 0.001190, 0.000000, -0.001617, -0.003235, -0.004028, -0.003235, -0.000793, 0.001617, 0.003632, 0.004456, 0.004028, 0.002808, 0.001617, 0.001190, 0.001617, 0.002014, 0.002014, 0.001617, 0.000397, -0.001617, -0.004028, -0.005646, -0.006866, -0.006866, -0.006866, -0.005646, -0.004028, -0.002411, -0.000793, 0.000000, 0.000397, 0.000793, 0.000793, 0.000397, -0.000397, -0.001617, -0.002411, -0.002808, -0.002014, -0.001190, -0.000793, 0.000397, 0.002014, 0.004028, 0.006073, 0.008087, 0.009308, 0.009705, 0.010101, 0.010101, 0.009705, 0.009308, 0.008484, 0.007263, 0.005249, 0.002808, 0.000397, -0.002014, -0.003235, -0.004456, -0.004852, -0.004852, -0.004852, -0.005249, -0.005249, -0.005249, -0.005646, -0.006470, -0.008087, -0.009308, -0.010101, -0.009705, -0.007690, -0.004852, -0.002014, 0.000793, 0.002411, 0.003235, 0.002808, 0.002411, 0.002411, 0.003235, 0.005249, 0.007690, 0.008087, 0.006866, 0.004852, 0.002014, 0.000000, -0.000793, -0.000397, 0.000397, 0.002014, 0.003632, 0.005249, 0.006073, 0.006470, 0.006073, 0.005249, 0.004028, 0.003235, 0.002411, 0.002014, 0.002411, 0.003235, 0.004028, 0.004028, 0.004028, 0.004456, 0.004852, 0.004852, 0.004028, 0.002411, 0.000793, -0.001190, -0.002808, -0.002411, -0.001190, 0.000000, 0.000793, 0.000000, -0.002014, -0.004028, -0.006073, -0.007263, -0.008087, -0.008484, -0.007690, -0.006073, -0.003632, -0.002014, -0.001190, -0.001190, -0.001617, -0.002014, -0.002808, -0.003632, -0.004028, -0.002808, -0.000397, 0.002014, 0.004028, 0.004852, 0.004852, 0.004852, 0.004456, 0.003632, 0.002411, 0.000793, -0.000397, -0.001617, -0.002014, -0.001617, -0.000397, 0.001190, 0.002014, 0.002411, 0.002808, 0.003235, 0.003235, 0.002411, 0.001617, 0.000793, 0.000793, 0.001617, 0.002808, 0.004456, 0.005646, 0.006866, 0.007263, 0.006470, 0.004852, 0.002014, -0.001190, -0.003632, -0.004852, -0.004852 };

struct Material {
    Material(float density, float yMod, float pRatio, const ofColor& color)
        : density(density), yMod(yMod), pRatio(pRatio), color(color) {}
    float density;
    float yMod;
    float pRatio;
    ofColor color;
};

static const Material materials[NUM_MATERIALS] = { Material(123.4f, 8940.f, 0.34f, ofColor(255, 0, 0, 255)),
                                                   Material(72.f, 2700.f, 0.19f, ofColor(0, 255, 0, 255)),
                                                   Material(62.f, 2700.f, 0.20f, ofColor(0, 0, 255, 255)), 
                                                   Material(2.4f, 1200.f, 0.37f, ofColor(255, 0, 255, 255)) };


//--------------------------------------------------------------
void ofApp::setup(){
    windowResized(ofGetWidth(), ofGetHeight());

    // initialize light
    ofSetSmoothLighting(true);
    pointLight.setDiffuseColor(ofFloatColor(.85, .85, .55));
    pointLight.setSpecularColor(ofFloatColor(1.f, 1.f, 1.f));


    // initialize ball positions, velocities, rFactors to random values
    const float MAX_SPEED = 500.f;
    const float MIN_RFACTOR = 0.3f;
    const float MAX_RFACTOR = 0.9f;
    for (int i = 0; i < N_BALLS; i++) {
        balls[i].p.x = pMin.x + ofRandomuf() * (pMax.x - pMin.x);
        balls[i].p.y = pMin.y + ofRandomuf() * (pMax.y - pMin.y);
        balls[i].p.z = pMin.z + ofRandomuf() * (pMax.z - pMin.z);

        // randomly sample point on unit sphere with uniform distribution
        float theta = TWO_PI * ofRandomuf();
        float phi = acosf(2.f * ofRandomuf() - 1.f);
        float speed = ofRandomuf() * MAX_SPEED;
        balls[i].v.x = speed * sinf(phi) * cosf(theta);
        balls[i].v.y = speed * sinf(phi) * sinf(theta);
        balls[i].v.z = speed * cosf(phi);

        balls[i].rFactor = MIN_RFACTOR + ofRandomuf() * (MAX_RFACTOR - MIN_RFACTOR);

        // choose a material
        int mi = min((int)(ofRandomuf() * NUM_MATERIALS), NUM_MATERIALS - 1);
        balls[i].m = 0.001f * BALL_RADIUS * BALL_RADIUS * BALL_RADIUS * materials[mi].density;
        balls[i].yMod = materials[mi].yMod;
        balls[i].pRatio = materials[mi].pRatio;
        balls[i].color = materials[mi].color;
    }

    gravity = ofVec3f(0.f, GRAVITY_MAG, 0.f);
    attract = false;
    
    ballCollisionTable = new float[N_BALLS * N_BALLS];

    ofSoundStreamSetup(2, 0, AUDIO_SAMPLE_RATE, 256, 4);
    ofSetFrameRate(60);
}

void ofApp::exit() {
    delete[] ballCollisionTable;
}


enum WallId{ NONE = -1, XMIN = -2, XMAX = -3, YMIN = -4, YMAX = -5, ZMIN = -6, ZMAX = -7 };


// will return smaller root
static bool spheresCollide(const ofVec3f& c1, float r1, const ofVec3f& v1,
                           const ofVec3f& c2, float r2, const ofVec3f& v2,
                           float* t) {
    ofVec3f cDiff = c1 - c2;
    ofVec3f vDiff = v1 - v2;
    float rSum = r1 + r2;
    float a = vDiff.lengthSquared();
    float b_over_2 = cDiff.dot(vDiff);
    float c = cDiff.lengthSquared() - rSum*rSum;
    float D_over_4 = b_over_2*b_over_2 - a*c;    
    if (D_over_4 < 0.f) {
        return false;
    }
    if (b_over_2 > 0.f) {
        float z = -b_over_2 - sqrtf(D_over_4);
        *t = z / a;
    } else {
        float z = -b_over_2 + sqrtf(D_over_4);
        *t = c / z;
    }
    return true;
}

// will update t to time of first wall collision, and update wallId to that wall
int ofApp::wallCollide(const ofVec3f& c1, float r1, const ofVec3f& v1, float tMin, float* t) {
    *t = positiveInfinity;
    int id = NONE;
    if (v1.x > 0.f) {
        //assert(c1.x <= pMax.x);
        float tx = (pMax.x - c1.x) / v1.x;
        if (tx >= tMin && tx < *t) {
            *t = tx;
            id = XMAX;
        }
    } else {
        //assert(c1.x >= pMin.x);
        float tx = (pMin.x - c1.x) / v1.x;
        if (tx >= tMin && tx < *t) {
            *t = tx;
            id = XMIN;
        }
    }
    if (v1.y > 0.f) {
        //assert(c1.y <= pMax.y);
        float ty = (pMax.y - c1.y) / v1.y;
        if (ty >= tMin && ty < *t) {
            *t = ty;
            id = YMAX;
        }
    } else {
        //assert(c1.y >= pMin.y);
        float ty = (pMin.y - c1.y) / v1.y;
        if (ty >= tMin && ty < *t) {
            *t = ty;
            id = YMIN;
        }
    }
    if (v1.z > 0.f) {
        //assert(c1.z <= pMax.z);
        float tz = (pMax.z - c1.z) / v1.z;
        if (tz >= tMin && tz < *t) {
            *t = tz;
            id = ZMAX;
        }
    } else {
        //assert(c1.z >= pMin.z);             // will be triggered by the backstepping
        float tz = (pMin.z - c1.z) / v1.z;
        if (tz >= tMin && tz < *t) {
            *t = tz;
            id = ZMIN;
        }
    }
    return id;
}

//--------------------------------------------------------------
void ofApp::update(){
    float dt = ofGetLastFrameTime();
    
    // update ball velocities with gravity and attractive force
    for (int i = 0; i < N_BALLS; i++) {
        balls[i].v += dt * gravity;
    }
    if (attract) {
        for (int i = 0; i < N_BALLS; i++) {
            ofVec3f toAttractPos = attractPos - balls[i].p;
            float dSq = toAttractPos.lengthSquared();
            ofVec3f accel = (MOUSE_CURSOR_MASS / dSq) * toAttractPos;    // falls off as R
            balls[i].v += dt * accel;
        }
    }

    // compute collision times between all object pairs
    for (int i = 0; i < N_BALLS; i++) {
        wallCollisionTable[i].id = wallCollide(balls[i].p, BALL_RADIUS, balls[i].v, 0.f, &wallCollisionTable[i].t);
        for (int j = i + 1; j < N_BALLS; j++) {
            float t = -1.f;
            spheresCollide(balls[i].p, BALL_RADIUS, balls[i].v, balls[j].p, BALL_RADIUS, balls[j].v, &t);
            ballCollisionTable[i * N_BALLS + j] = t;
            //ballCollisionTable[j * N_BALLS + i] = t;
        }
    }
    
    
    const float vn_unattenuated = dt * 60000.f;
    const float vn_threshold = 3.f * dt * GRAVITY_MAG;

    float tAt = 0.f;
    while (true) {
        // find the ball with the nearest next collision (occurs after tAt)
        int ci = -1;
        Collision collision;
        collision.t = positiveInfinity;
        collision.id = NONE;
        for (int i = 0; i < N_BALLS; i++) {
            if (wallCollisionTable[i].t >= tAt && wallCollisionTable[i].t < collision.t) {
                ci = i;
                collision = wallCollisionTable[i];
            }
            for (int j = i + 1; j < N_BALLS; j++) {
                if (ballCollisionTable[i * N_BALLS + j] >= tAt && ballCollisionTable[i * N_BALLS + j] < collision.t) {
                    ci = i;
                    collision.t = ballCollisionTable[i * N_BALLS + j];
                    collision.id = j;
                }
            }
        }
        if (collision.t >= dt) {
            break;
        }
        assert(collision.t >= tAt);
        assert(collision.id != NONE);

        float vn;

        if (collision.id < -1) {            // wall collision
            Sphere& cBall = balls[ci];
            ofVec3f vNext = cBall.v;
            switch (collision.id) {
            case XMIN:
            case XMAX:
                vNext.x *= -cBall.rFactor;
                vn = abs(cBall.v.x);
                break;
            case YMIN:
            case YMAX:
                vNext.y *= -cBall.rFactor;
                vn = abs(cBall.v.y);
                break;
            case ZMIN:
            case ZMAX:
                vNext.z *= -cBall.rFactor;
                vn = abs(cBall.v.z);
                break;
            }
            cBall.p += collision.t * (cBall.v - vNext); // move it to contact point, then backstep in time
            cBall.v = vNext;

            // update collision tables
            updateBallCollisions(ci, collision.t);
        } else {    //if (collision.id >= 0) {     // ball collision
            assert(ci != collision.id);

            int ci2 = collision.id;
            Sphere& cBall = balls[ci];
            Sphere& cBall2 = balls[ci2];

            ofVec3f p1 = cBall.p + collision.t * cBall.v;
            ofVec3f p2 = cBall2.p + collision.t * cBall2.v;
            ofVec3f n = (p1 - p2).normalized();

            float eps = 0.5f * (cBall.rFactor + cBall2.rFactor);

            vn = (cBall.v - cBall2.v).dot(n);
            float J = -(1.f + eps)*vn / (1.f / cBall.m + 1.f / cBall2.m);
            ofVec3f vNext = cBall.v + J / cBall.m * n;
            ofVec3f vNext2 = cBall2.v - J / cBall2.m * n;

            cBall.p += collision.t * (cBall.v - vNext);     // move to contact pt, then backstep
            cBall2.p += collision.t * (cBall2.v - vNext2);
            cBall.v = vNext;
            cBall2.v = vNext2;

            // update collision tables
            updateBallCollisions(ci, collision.t);
            updateBallCollisions(ci2, collision.t);
        }

        // add new wav instance for collision sound
        float atten = (vn - vn_threshold) / (vn_unattenuated - vn_threshold);
        atten = min(atten, 1.f);
        if (atten > 0.f) {
            int samplesStartAt = SAMPLES_DELAY + (int)(collision.t * AUDIO_SAMPLE_RATE);
            int samplesToAdd = 2 * WAV_SAMPLES;
            int additionalCapcityNeeded = samplesStartAt + samplesToAdd - audioBuffer.size();
            if (additionalCapcityNeeded > 0) {
                int zerosPushed = audioBuffer.pushZeros(additionalCapcityNeeded);
                assert(zerosPushed == additionalCapcityNeeded);
            }
            audioBufferLock.lock();
            auto iter = audioBuffer.at(samplesStartAt);
            for (int i = 0; i < WAV_SAMPLES; i++) {
                *iter += atten * wav[i];        // 2 channels
                ++iter;
                *iter += atten * wav[i];
                ++iter;
            }
            audioBufferLock.unlock();
        }
        tAt = collision.t;
    }


    // update all ball positions to end of frame
    for (int i = 0; i < N_BALLS; i++) {
        balls[i].p += dt * balls[i].v;
    }
}

void ofApp::updateBallCollisions(int index, float tMin) {
    wallCollisionTable[index].id = wallCollide(balls[index].p, BALL_RADIUS, balls[index].v, tMin, &wallCollisionTable[index].t);
    for (int i = 0; i < index; i++) {
        float t = -1.f;
        spheresCollide(balls[index].p, BALL_RADIUS, balls[index].v, balls[i].p, BALL_RADIUS, balls[i].v, &t);
        ballCollisionTable[i * N_BALLS + index] = t;
    }
    for (int j = index + 1; j < N_BALLS; j++) {
        float t = -1.f;
        spheresCollide(balls[index].p, BALL_RADIUS, balls[index].v, balls[j].p, BALL_RADIUS, balls[j].v, &t);
        ballCollisionTable[index * N_BALLS + j] = t;
    }
}

//--------------------------------------------------------------
void ofApp::draw(){
    ofBackground(0);

    ofEnableLighting();
    pointLight.enable();

    ofEnableDepthTest();
    
    ofSetColor(200, 200, 200);
    leftWall.draw();
    rightWall.draw();
    backWall.draw();
    topWall.draw();
    bottomWall.draw();

    // draw balls
    ofIcoSpherePrimitive sphere(BALL_RADIUS, 1);
    for (int i = 0; i < N_BALLS; i++) {
        sphere.setPosition(balls[i].p);
        ofSetColor(balls[i].color);
        sphere.draw();
    }

    ofDrawBitmapString(ofToString(ofGetFrameRate()) + "fps", 10, 15);
}

//--------------------------------------------------------------
void ofApp::audioOut(float* output, int bufferSize, int nChannels) {
    audioBufferLock.lock();
    int samplesPopped = audioBuffer.pop(output, bufferSize * nChannels);
    audioBufferLock.unlock();
    int samplesRemaining = nChannels * bufferSize - samplesPopped;
    if (samplesRemaining > 0) {
        memset(&output[samplesPopped], 0, samplesRemaining);
    }
}

//--------------------------------------------------------------
void ofApp::keyPressed(int key){

}

//--------------------------------------------------------------
void ofApp::keyReleased(int key){
    switch (key) {
    case OF_KEY_LEFT:
        gravity = ofVec3f(-GRAVITY_MAG, 0.f, 0.f);
        break;
    case OF_KEY_RIGHT:
        gravity = ofVec3f(GRAVITY_MAG, 0.f, 0.f);
        break;
    case OF_KEY_UP:
        gravity = ofVec3f(0.f, -GRAVITY_MAG, 0.f);
        break;
    case OF_KEY_DOWN:
        gravity = ofVec3f(0.f, GRAVITY_MAG, 0.f);
        break;
    default:
        break;
    }
}

//--------------------------------------------------------------
void ofApp::mouseMoved(int x, int y ){

}

//--------------------------------------------------------------
void ofApp::mouseDragged(int x, int y, int button){
    attractPos = ofVec3f(x, y, 0.5f * (BOX_ZMIN + BOX_ZMAX));
}

//--------------------------------------------------------------
void ofApp::mousePressed(int x, int y, int button){
    attract = true;
    attractPos = ofVec3f(x, y, 0.5f * (BOX_ZMIN + BOX_ZMAX));
}

//--------------------------------------------------------------
void ofApp::mouseReleased(int x, int y, int button){
    attract = false;
}

//--------------------------------------------------------------
void ofApp::windowResized(int w, int h){
    ofSetupScreenPerspective(w, h, 60.f, BOX_ZMAX, BOX_ZMIN);

    pMin.x = BALL_RADIUS;
    pMax.x = w - BALL_RADIUS;
    pMin.y = BALL_RADIUS;
    pMax.y = h - BALL_RADIUS;
    pMin.z = BOX_ZMIN + BALL_RADIUS;
    pMax.z = BOX_ZMAX - BALL_RADIUS;

    for (int i = 0; i < N_BALLS; i++) {
        balls[i].p.x = std::max(std::min(balls[i].p.x, pMax.x), pMin.x);
        balls[i].p.y = std::max(std::min(balls[i].p.y, pMax.y), pMin.y);
        balls[i].p.z = std::max(std::min(balls[i].p.z, pMax.z), pMin.z);
    }


    pointLight.setPosition(w / 2, 10.f, 0.5f*(BOX_ZMIN + BOX_ZMAX));

    // initialize walls

    leftWall = ofPlanePrimitive(BOX_ZMAX - BOX_ZMIN, h, 8, 8);
    rightWall = leftWall;
    leftWall.setPosition(0.f, h / 2, 0.5f*(BOX_ZMIN + BOX_ZMAX));
    leftWall.rotate(90.f, 0.f, 1.f, 0.f);
    rightWall.setPosition(w, h / 2, 0.5f*(BOX_ZMIN + BOX_ZMAX));
    rightWall.rotate(-90.f, 0.f, 1.f, 0.f);

    backWall = ofPlanePrimitive(w, h, 8, 8);
    backWall.setPosition(w / 2, h / 2, BOX_ZMIN);

    topWall = ofPlanePrimitive(w, BOX_ZMAX - BOX_ZMIN, 8, 8);
    bottomWall = topWall;
    topWall.setPosition(w / 2, 0.f, 0.5f*(BOX_ZMIN + BOX_ZMAX));
    topWall.rotate(-90.f, 1.f, 0.f, 0.f);
    bottomWall.setPosition(w / 2, h, 0.5f*(BOX_ZMIN + BOX_ZMAX));
    bottomWall.rotate(90.f, 1.f, 0.f, 0.f);
}

//--------------------------------------------------------------
void ofApp::gotMessage(ofMessage msg){

}

//--------------------------------------------------------------
void ofApp::dragEvent(ofDragInfo dragInfo){ 

}
